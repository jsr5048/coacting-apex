!function(a,b,c,d,e,f){"use strict";function g(a){return e.getMessage("PD.CV."+a)}function h(a){var b=g(a),c=[b].concat(Array.prototype.slice.call(arguments,1));return e.format.apply(this,c)}function i(b,c){var d,e;b.markup('<div class="a-CV-group"><div class="a-CV-groupHeader"><h3 class="a-CV-groupTitle">'),c.title?b.content(c.title):b.content(a.getComponentType(c.componentTypeId).title.plural),b.markup("</h3>"),!a.isPageReadOnly()&&c.componentTypeId&&(d=a.getComponentType(c.componentTypeId).createUrl,b.markup('<a class="a-Button a-Button--regionHeader create" href="#" '),d?b.attr("data-url",d):(b.attr("data-componenttypeid",c.componentTypeId),c.property&&b.attr("data-propertyid",c.property.id).attr("data-propertyvalue",c.property.value)),e=h("CREATE_COMPONENT",a.getComponentType(c.componentTypeId).title.singular),b.markup(' title="'+e+'" aria-label="'+e+'"><span class="a-Icon icon-plus" aria-hidden="true"></span></a>')),b.markup('</div><div class="a-CV-groupBody" '),c.domId&&b.attr("id",c.domId),b.markup(">")}function j(a){a.markup("</div></div>")}function k(c,d){var e="a-CV-componentGroup";c.markup("<div "),d.hasWarnings&&(e+=" "+b.CSS.IS_WARNING),c.attr("class",e),d.component instanceof a.Component&&c.attr("data-componenttypeid",d.component.typeId).attr("data-componentid",d.component.id),c.markup(">"),(d.component||d.title)&&(c.markup('<h4 class="a-CV-componentGroupTitle">'),d.component instanceof a.Component?c.markup('<span class="a-CV-componentGroupTitle-context">').content(a.getComponentType(d.component.typeId).title.singular).markup('</span><a class="edit" href="#" title="">').content(d.component.getDisplayTitle()).markup("</a>"):c.content(d.title),c.markup("</h4>"))}function l(a){a.markup("</div>")}function m(a){return"CVT"+a.typeId+"_"+a.id}function n(c,d,e){function g(){for(var a="",b=0;b<e.indent;b++)a+='<span class="a-CV-indent"></span>';return a}function h(b){var c={NATIVE_IR:a.COMP_TYPE.IR_ATTRIBUTES,NATIVE_IG:a.COMP_TYPE.IG_ATTRIBUTES,NATIVE_SQL_REPORT:a.COMP_TYPE.CLASSIC_REPORT,NATIVE_FNC_REPORT:a.COMP_TYPE.CLASSIC_REPORT,NATIVE_TABFORM:a.COMP_TYPE.TABULAR_FORM,NATIVE_FLASH_MAP:a.COMP_TYPE.MAP_CHART,NATIVE_FLASH_CHART5:a.COMP_TYPE.CHART,NATIVE_JET_CHART:a.COMP_TYPE.JET_CHART,NATIVE_CALENDAR:a.COMP_TYPE.CLASSIC_CALENDAR},e=a.COMP_TYPE.REGION_PLUGIN_ATTR;return c.hasOwnProperty(b)&&(e=c[b]),a.getComponents(e,{parentId:d.id})}function i(){var c,e=d.getProperty(a.PROP.BUTTON_TARGET);return c=e?b.splitApexUrl(e.getValue(),!0).display:d.getProperty(a.PROP.BUTTON_ACTION).getDisplayValue()}var j,k,l,n,o="",p=[];b.isNever(d)?o+=" "+b.CSS.IS_NEVER:b.isConditional(d)&&(o+=" "+b.CSS.IS_CONDITIONAL),d.hasChanged()&&(o+=" "+b.CSS.IS_CHANGED),d.hasErrors()&&(o+=" "+b.CSS.IS_ERROR),d.hasWarnings()&&(o+=" "+b.CSS.IS_WARNING),c.markup("<li ").attr("id",m(d)).attr("class","a-CV-component"+o).attr("data-componenttypeid",d.typeId).attr("data-componentid",d.id).markup(">"),e.type&&(k=f.isArray(e.type)?d.getProperty(e.type[0])||d.getProperty(e.type[1]):d.getProperty(e.type)),e.seq&&c.markup('<span class="a-CV-cell a-CV-cell--seq u-tE">').content(d.getProperty(e.seq).getDisplayValue()).markup("</span>"),e.name&&(c.markup('<span class="a-CV-cell a-CV-cell--primary">'),e.icon&&("region"===e.icon||"item"===e.icon?(n=b.getComponentIconClass(e.icon,k.getValue()),l=k.getDisplayValue()):"button"===e.icon?(n=b.getComponentIconClass("button","Y"===d.getProperty(a.PROP.BUTTON_IS_HOT).getValue()?"hot":"normal"),l=""):(n=e.icon,l=""),c.markup('<span class="a-CV-cellWrap">'+g()+"<span ").attr("class","a-CV-icon a-Icon "+n).attr("title",l).markup('></span><span class="u-VisuallyHidden">').content(l).markup("</span>")),c.markup('<a class="edit" href="#" title="">'),d.typeId===a.COMP_TYPE.REGION||e.name===!0?c.content(d.getDisplayTitle()):c.content(d.getProperty(e.name).getDisplayValue()),c.markup("</a></span>"),e.icon&&c.markup("</span>")),e.additional&&(j=e.additional.apply(d),c.markup('<span class="a-CV-cell a-CV-cell--secondary">').content(j).markup("</span>")),k&&(c.markup('<span class="a-CV-cell a-CV-cell--secondary">'),d.typeId===a.COMP_TYPE.REGION&&(p=h(k.getValue())),p.length>0?c.markup('<a class="edit" href="#" title=""').attr("data-componenttypeid",p[0].typeId).attr("data-componentid",p[0].id).markup(">").content(k.getDisplayValue()).markup("</a></span>"):k.id===a.PROP.BUTTON_ACTION?c.content(i()):c.content(k.getDisplayValue()),c.markup("</span>")),c.markup("</li>")}function o(c,d){var e,g,h={},i=[],j={},m=!1;if(f.isArray(d.component))for(g=0;g<d.component.length;g++)i[g]={typeId:d.component[g].typeId,filter:d.component[g].filter},j[d.component[g].typeId]=d.component[g];else i[0]={typeId:d.component.typeId,filter:d.component.filter},j[d.component.typeId]=d.component;if(e=a.getComponentsAdvanced(i),e.length>0){for(g=0;g<e.length;g++)if(!e[g].isOnGlobalPage()&&b.isDisplayed(e[g])){m=!0;break}if(m){for(d.header&&(h=d.header.component instanceof a.Component?{component:d.header.component}:d.header.title?{title:d.header.title}:{title:a.getComponentType(d.component.typeId).title.plural},h.hasWarnings=d.header.hasWarnings,k(c,h)),d.noComponentGrouping||c.markup('<ul class="a-CV-components">'),g=0;g<e.length;g++)!e[g].isOnGlobalPage()&&b.isDisplayed(e[g])&&(n(c,e[g],j[e[g].typeId].display),j[e[g].typeId].addSubComponents&&j[e[g].typeId].addSubComponents(c,e[g]));d.noComponentGrouping||c.markup("</ul>"),d.header&&l(c)}}}function p(a,b){return b.find("#"+c.escapeCSS(m(a)))}function q(a){for(var b=0;b<P.length;b++)p(P[b],a).addClass(N.IS_SELECTED)}function r(e,g){function h(a){var b=c.htmlBuilder(),h=f("#"+e.domId);d.trace("%s: CHANGE/ADD_PROP/REMOVE_PROP component notification received for display relevant properties",e.domId,a),g(b),h.empty().append(b.toString()),q(h)}function i(a){a&&m.push(a)}var j,k,l=[],m=[];if(i(e.display.seq),i(e.display.name),i(e.display.additional),i(e.display.type),i(e.pointPropertyId),l=e.componentTypeId?[{typeId:e.componentTypeId}]:e.components,e.addProperties)for(k=0;k<e.addProperties.length;k++)i(e.addProperties[k]);a.observer(M,{components:l,events:[a.EVENT.CREATE,a.EVENT.DELETE]},h,!0),a.observer(M,{components:l,events:[a.EVENT.CHANGE,a.EVENT.ADD_PROP,a.EVENT.REMOVE_PROP],properties:m},h,!0),a.observer(M,{components:l,events:[a.EVENT.ERRORS,a.EVENT.NO_ERRORS,a.EVENT.WARNINGS,a.EVENT.NO_WARNINGS]},function(a){function c(b,c){b?p(a.component,j).addClass(c):p(a.component,j).removeClass(c)}j=f("#"+e.domId),c(a.component.hasErrors(),b.CSS.IS_ERROR),c(a.component.hasWarnings(),b.CSS.IS_WARNING)}),b.observerIsConditional(M,l,function(a){j=f("#"+e.domId),p(a.component,j).removeClass(b.CSS.IS_CONDITIONAL),p(a.component,j).removeClass(b.CSS.IS_NEVER),b.isNever(a.component)?p(a.component,j).addClass(b.CSS.IS_NEVER):b.isConditional(a.component)&&p(a.component,j).addClass(b.CSS.IS_CONDITIONAL)})}function s(b,c){function d(b){var d;for(d=0;d<c.points.length;d++)o(b,{header:{title:a.getLovTitle(c.componentTypeId,c.pointPropertyId,c.points[d])},component:{typeId:c.componentTypeId,filter:{properties:[{id:c.pointPropertyId,value:c.points[d]}]},display:c.display}})}i(b,{domId:c.domId,componentTypeId:c.componentTypeId,property:{id:c.pointPropertyId,value:c.defaultCreatePoint}}),d(b),j(b),r(c,d)}function t(b,c,d){var e,f={},h="";for(c instanceof a.Component?(h=c.id,f.component=c):(f.title=g("NO_REGION"),f.hasWarnings=!0),e=0;e<d.length;e++)d[e].filter.properties&&d[e].filter.properties.push({id:a.PROP.REGION,value:h});o(b,{header:f,component:d})}function u(b,c,d,e){s(b,{domId:c,componentTypeId:a.COMP_TYPE.BRANCH,pointPropertyId:a.PROP.BRANCH_POINT,defaultCreatePoint:e,points:d,display:{seq:a.PROP.EXECUTION_SEQUENCE,icon:"icon-tree-branch",name:a.PROP.NAME,type:a.PROP.BRANCH_TYPE}})}function v(b,c){function d(a){o(a,{header:!1,component:{typeId:e.componentTypeId,display:e.display}})}var e={domId:c,componentTypeId:a.COMP_TYPE.VALIDATION,display:{seq:a.PROP.EXECUTION_SEQUENCE,icon:"icon-tree-validation",name:a.PROP.NAME,type:[a.PROP.VALIDATION_TYPE,a.PROP.REGION_VALIDATION_TYPE]}};i(b,{domId:e.domId,componentTypeId:e.componentTypeId}),d(b),j(b),r(e,d)}function w(b,c,d,e){s(b,{domId:c,componentTypeId:a.COMP_TYPE.PAGE_COMPUTATION,pointPropertyId:a.PROP.COMPUTATION_POINT,defaultCreatePoint:e,points:d,display:{seq:a.PROP.EXECUTION_SEQUENCE,icon:"icon-tree-computation",name:a.PROP.COMPUTATION_ITEM_NAME,type:a.PROP.COMPUTATION_TYPE}})}function x(b,c,d,e){s(b,{domId:c,componentTypeId:a.COMP_TYPE.PAGE_PROCESS,pointPropertyId:a.PROP.PROCESS_POINT,defaultCreatePoint:e,points:d,display:{seq:a.PROP.EXECUTION_SEQUENCE,icon:"icon-tree-process",name:a.PROP.NAME,type:a.PROP.PAGE_PROCESS_TYPE}})}function y(b,c){function d(a){o(a,{header:!1,component:{typeId:e.componentTypeId,display:e.display}})}var e={domId:c,componentTypeId:a.COMP_TYPE.DA_EVENT,display:{seq:a.PROP.EXECUTION_SEQUENCE,icon:"icon-tree-da-event",name:a.PROP.NAME,additional:function(){var a,b;for(a=0;a<O.length;a++)if(b=this.getProperty(O[a]))return b.getDisplayValue();return""},type:a.PROP.EVENT}};i(b,{domId:e.domId,componentTypeId:e.componentTypeId}),d(b),j(b),e.addProperties=O,r(e,d)}function z(b,c,d){function e(a,b){z(a,{region:b},d+1)}var f={},h={};c.hasOwnProperty("region")?(h=!1,f.properties=[{id:a.PROP.PARENT_REGION,value:c.region.id}]):c.hasOwnProperty("point")?(h.title=c.point.name,f.properties=[],f.properties.push({id:a.PROP.PARENT_REGION,value:""}),f.properties.push({id:a.PROP.REGION_POSITION,value:c.point.id})):c.hasOwnProperty("validPointsMap")&&(h.title=g("INVALID_POSITION"),h.hasWarnings=!0,f.filterFunction=function(){var b=this.getProperty(a.PROP.REGION_POSITION);return!!b&&!c.validPointsMap.hasOwnProperty(b.getValue())}),o(b,{header:h,component:{typeId:a.COMP_TYPE.REGION,filter:f,addSubComponents:e,display:{seq:a.PROP.DISPLAY_SEQUENCE,icon:"region",name:a.PROP.TITLE,type:a.PROP.REGION_TYPE,indent:d}},noComponentGrouping:d>0})}function A(b,c){t(b,c,[{typeId:a.COMP_TYPE.PAGE_ITEM,filter:{properties:[]},display:{seq:a.PROP.DISPLAY_SEQUENCE,icon:"item",name:a.PROP.ITEM_NAME,additional:function(){var b=this.getProperty(a.PROP.ITEM_LABEL);return b?b.getDisplayValue():""},type:a.PROP.ITEM_TYPE}},{typeId:a.COMP_TYPE.BUTTON,filter:{properties:[{id:a.PROP.BUTTON_POSITION,value:"BODY"}]},display:{seq:a.PROP.DISPLAY_SEQUENCE,icon:"button",name:a.PROP.BUTTON_LABEL,type:a.PROP.BUTTON_ACTION}}])}function B(b,c){var d=c instanceof a.Component?c.id:"";t(b,c,[{typeId:a.COMP_TYPE.BUTTON,filter:{filterFunction:function(){return this.getProperty(a.PROP.REGION).getValue()===d&&"BODY"!==this.getProperty(a.PROP.BUTTON_POSITION).getValue()}},display:{seq:a.PROP.DISPLAY_SEQUENCE,icon:"button",name:a.PROP.BUTTON_LABEL,type:a.PROP.BUTTON_ACTION}}])}function C(b,c){function d(b){var c,d;for(c=a.getPageTemplate(),z(b,{validPointsMap:c.displayPointsMap},0),d=0;d<c.displayPoints.length;d++)z(b,{point:c.displayPoints[d]},0)}i(b,{domId:c,componentTypeId:a.COMP_TYPE.REGION}),d(b),j(b),r({domId:c,components:[{typeId:a.COMP_TYPE.REGION},{typeId:a.COMP_TYPE.PAGE}],display:{seq:a.PROP.DISPLAY_SEQUENCE,name:a.PROP.TITLE,type:a.PROP.REGION_TYPE},addProperties:[a.PROP.PARENT_REGION,a.PROP.REGION_POSITION,a.PROP.PAGE_TEMPLATE,a.PROP.DIALOG_TEMPLATE]},d)}function D(b,c){function d(b){var c,d=a.getComponents(a.COMP_TYPE.REGION,{});for(A(b,null),c=0;c<d.length;c++)A(b,d[c])}i(b,{domId:c,componentTypeId:a.COMP_TYPE.PAGE_ITEM}),d(b),j(b),r({domId:c,components:[{typeId:a.COMP_TYPE.REGION},{typeId:a.COMP_TYPE.PAGE_ITEM},{typeId:a.COMP_TYPE.BUTTON}],display:{},addProperties:[a.PROP.DISPLAY_SEQUENCE,a.PROP.ITEM_NAME,a.PROP.ITEM_LABEL,a.PROP.ITEM_TYPE,a.PROP.BUTTON_LABEL,a.PROP.BUTTON_ACTION,a.PROP.BUTTON_TARGET,a.PROP.REGION,a.PROP.TITLE]},d)}function E(b,c){function d(b){var c,d=a.getComponents(a.COMP_TYPE.REGION,{});for(B(b,null),c=0;c<d.length;c++)B(b,d[c])}i(b,{domId:c,componentTypeId:a.COMP_TYPE.BUTTON}),d(b),j(b),r({domId:c,components:[{typeId:a.COMP_TYPE.REGION},{typeId:a.COMP_TYPE.BUTTON}],display:{},addProperties:[a.PROP.DISPLAY_SEQUENCE,a.PROP.BUTTON_LABEL,a.PROP.BUTTON_ACTION,a.PROP.BUTTON_TARGET,a.PROP.REGION,a.PROP.TITLE]},d)}function F(){var b,c,d,e=f(this),g=e.data("url"),h=e.data("componenttypeid")+"",i=e.data("propertyid"),j=e.data("propertyvalue"),k=[];g?H(g):(i&&k.push({id:i,value:j}),b=a.transaction.message({action:a.MESSAGE_ACTION.CREATE,component:h}),c=a.transaction.start("",b),d=new a.Component({previousComponent:"last",typeId:h,values:k}),apex.commandHistory.execute(c),window.pageDesigner.goToComponent(d.typeId,d.id))}function G(){var b=f(this).closest("[data-componentid]"),c=a.getComponents(b.data("componenttypeid"),{id:b.data("componentid")})[0];window.pageDesigner.goToComponent(c.typeId,c.id,b.data("propertyid"))}function H(b,c){apex.navigation.redirect(b.replace(/\\u002525/g,"%").replace(/%25/g,"%").replace(/%session%/g,$v("pInstance")).replace(/%pk_value%/g,c).replace(/%application_id%/g,a.getCurrentAppId()).replace(/%page_id%/g,a.getCurrentPageId()))}function I(a,b){a.empty().append(b.toString()).on("click","a.create",F).on("click","a.edit",G)}function J(b){var d=c.htmlBuilder();C(d,"cvRenderingRegions"),E(d,"cvRenderingRegionButtons"),D(d,"cvRenderingPageItems"),a.isGlobalPage()||(w(d,"cvRenderingComputations",["ON_NEW_INSTANCE","BEFORE_HEADER","AFTER_HEADER","BEFORE_BOX_BODY","AFTER_BOX_BODY","BEFORE_FOOTER","AFTER_FOOTER"],"AFTER_HEADER"),x(d,"cvRenderingProcesses",["ON_NEW_INSTANCE","BEFORE_HEADER","AFTER_HEADER","BEFORE_BOX_BODY","AFTER_BOX_BODY","BEFORE_FOOTER","AFTER_FOOTER"],"AFTER_HEADER"),y(d,"cvRenderingDynamicActions")),I(b,d)}function K(b){var d=c.htmlBuilder();a.isGlobalPage()||(w(d,"cvProcessingComputations",["AFTER_SUBMIT"],"AFTER_SUBMIT"),v(d,"cvProcessingValidations"),x(d,"cvProcessingProcesses",["ON_SUBMIT_BEFORE_COMPUTATION","AFTER_SUBMIT","ON_DEMAND"],"AFTER_SUBMIT"),u(d,"cvProcessingBranches",["BEFORE_COMPUTATION","BEFORE_VALIDATION","BEFORE_PROCESSING","AFTER_PROCESSING"],"AFTER_PROCESSING")),I(b,d)}function L(a){a.empty().off("click","a.create").off("click","a.edit")}var M="COMPONENT_VIEW",N={IS_SELECTED:"is-selected"},O=[a.PROP.WHEN_REGION,a.PROP.WHEN_BUTTON,a.PROP.WHEN_ITEMS,a.PROP.WHEN_DOM_OBJECT,a.PROP.WHEN_JQUERY_SELECTOR,a.PROP.WHEN_JAVASCRIPT_EXPRESSION],P=[];f(function(){var b=f("#componentView-container"),c=f("#PDrenderingCV"),e=f("#PDprocessingCV");f(document).on("modelReady",function(){J(c),K(e),f(document).on("selectionChanged."+M,function(a,c,e){c!==M&&(d.trace("%s: selectionChanged event received from %s",M,c,e),b.find("li.a-CV-component."+N.IS_SELECTED).removeClass(N.IS_SELECTED),P=e,q(b))}),f(document).one("modelCleared",function(){a.unobserver(M,{}),f(document).off("selectionChanged."+M),P=[],L(c),L(e)})})})}(pe,window.pageDesigner,apex.util,apex.debug,apex.lang,apex.jQuery);