!function(a,b,c,d,e){"use strict";function f(a){return c.getMessage(a)}function g(a,b,c){var d,e,f,g,h=a.scrollTop;return!(!a.selectionStart&&0!==a.selectionStart)&&(f=a.selectionStart,d=a.value.substring(0,f),e=a.value.substring(a.selectionEnd),b?(g="\t",f+=1):(g=L.substring(0,c),f+=c),a.value=d+g+e,a.selectionStart=a.selectionEnd=f,a.scrollTop=h,!0)}function h(a,b,c){var d,e=[0],f=a.value;return!(!a.selectionStart&&0!==a.selectionStart)&&(f.replace(/\n/gm,function(a,b){e.push(b+1)}),b>=e.length&&(b=e.length-1),d=b===e.length-1?f.length-e[b]:e[b+1]-e[b]-1,c>d&&(c=d),void(a.selectionStart=a.selectionEnd=e[b]+c))}function i(a,b){function c(a){var b,c=a.split("-"),d=c.pop();return c.sort(function(a,b){return P[a]-P[b]}),c.push(d),b=c.join("+").replace("Cmd+","Meta+"),Q&&(b=b.replace("Meta+","âŒ˜+").replace("Alt+","Option+")),b}var d,e,f,g;if(!a)return null;for(g=["extraKeys",a.getOption("keyMap")],e=0;e<g.length;e++){f="extraKeys"===g[e]?a.getOption("extraKeys"):CodeMirror.keyMap[g[e]];for(d in f)if(f.hasOwnProperty(d))if("fallthrough"===d)g=g.concat(f[d]);else if(f[d]===b)return c(d)}return null}function j(a){var b,c;for(b=0;b<O.length;b++)if(c=O[b],c.name===a)return c;return null}function k(b){var c=j(b);c.loaded||(a("head").append('<link type="text/css" href="'+N+"/theme/"+(c.fileName||c.name)+'.css" rel="stylesheet"/>'),c.loaded=!0)}function l(a,b,c){function d(a){for(var c,d,f=[],g=0;g<a.length;g++){c=a[g];for(var h=0;h<c.completions.length;h++)d=c.completions[h],f.push({text:d.r||d,displayText:(d.d||d)+" ("+c.title+")",className:c.className,type:c.type,hint:e})}f.sort(function(a,b){return a.displayText.toLowerCase().localeCompare(b.displayText.toLowerCase())}),b({list:f,from:CodeMirror.Pos(k.line,l.start),to:CodeMirror.Pos(k.line,l.end)})}function e(a,b,c){var d,e,f,g,h,i=c.text,j={};if("package"===c.type)i+=".";else if("procedure"===c.type||"function"===c.type)i+="()",d={line:b.from.line,ch:b.from.ch+i.length-1};else if("template"===c.type){if(e=i.match(/\$[a-z]{1,}\$/g)){for(var k=0;k<e.length;k++)f=e[k].substr(1,e[k].length-2),j.hasOwnProperty(f)||"cursor"===f||(j[f]=window.prompt(f));for(f in j)j.hasOwnProperty(f)&&(i=i.replace(new RegExp("\\$"+f+"\\$","gi"),j[f]))}b.from.ch>0&&(i=i.replace(/\n/g,"\n"+new Array(b.from.ch+1).join(" "))),g=i.indexOf("$cursor$"),g!==-1&&(h=i.lastIndexOf("\n",g),d=h!==-1?{line:b.from.line+(i.substr(0,g).match(/\n/g)||[]).length,ch:g-h-1}:{line:b.from.line,ch:b.from.ch+g},i=i.replace(/\$cursor\$/,""))}a.replaceRange(i,b.from,b.to),d&&a.doc.setCursor(d)}function f(b){var c=a.getTokenAt({line:k.line,ch:b.start});return"."===b.string?c:"."===c.string?f(c):null}var g,h,i,j,k=a.getCursor(),l=a.getTokenAt(k),m=l.string.trim();g=f(l),g&&""!==g.string?(h=g.string,i="",g=f(g),g&&(i=g.string),"."===m&&(m="",l.start++)):0===m.indexOf(":")||0===m.indexOf("&")?(j="item",m=m.substr(1),l.start++):j="",(h||m)&&c.dataCallback({type:j,search:m,parent:h,grantParent:i},d)}function m(a,b,d,e,f,g){a.markup("<button").attr("id",b).optionalAttr("title",d?c.formatMessage("CODE_EDITOR.SHORTCUT_TITLE",e,d):null).optionalBoolAttr("disabled",g).attr("class","a-Button"+(f?" "+f:"")).markup(" type='button'>").content(e).markup("</button>")}function n(a,b,d,e,f,g,h){var i=d?c.formatMessage("CODE_EDITOR.SHORTCUT_TITLE",f,d):f;a.markup("<button").attr("id",b).attr("title",i).attr("aria-label",i).optionalBoolAttr("disabled",h).attr("class","a-Button a-Button--noLabel a-Button--withIcon"+(g?" "+g:"")).markup(" type='button'>").markup("<span class='a-Icon ").attr(e).markup("' aria-hidden='true'></span></button>")}function o(a,b){return"string"==typeof a?a=new RegExp(a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),b?"gi":"g"):a.global||(a=new RegExp(a.source,a.ignoreCase?"gi":"g")),{token:function(b){a.lastIndex=b.pos;var c=a.exec(b.string);return c&&c.index===b.pos?(b.pos+=c[0].length,"searching"):void(c?b.pos=c.index:b.skipToEnd())}}}function p(){this.posFrom=this.posTo=this.query=null,this.overlay=null}function q(a){return a.state.search||(a.state.search=new p)}function r(b,c){var d=q(b),e=a(b.display.wrapper).parent();return d.query?void s(b,c):void e.codeEditor("showSearchBar",!1,b.getSelection())}function s(a,b){a.operation(function(){var c=q(a),d=a.getSearchCursor(c.query,b?c.posFrom:c.posTo,c.isCaseInsensitive);(d.find(b)||(d=a.getSearchCursor(c.query,b?CodeMirror.Pos(a.lastLine()):CodeMirror.Pos(a.firstLine(),0),c.isCaseInsensitive),d.find(b)))&&(a.setSelection(d.from(),d.to()),a.scrollIntoView({from:d.from(),to:d.to()}),c.posFrom=d.from(),c.posTo=d.to())})}function t(a){a.operation(function(){var b=q(a);b.query&&(b.query=null,a.removeOverlay(b.overlay))})}function u(b){var c=a(b.display.wrapper).parent();b.getOption("readOnly")||c.codeEditor("showSearchBar",!0,b.getSelection())}var v="a-CodeEditor",w="a-CodeEditor--textarea",x="is-active",y="a-CodeEditor-searchBar",z="."+y,A="a-CodeEditor-replace",B="."+A,C="a-CodeEditor-notification",D="."+C,E="a-CodeEditor-message",F="."+E,G="a-CodeEditor-toolbar",H="."+G,I=".CodeMirror",J=["usePlainTextArea","theme","indentUnit","tabSize","indentWithTabs","lineNumbers","ruler"],K=a.ui.keyCode,L="                                        ",M=[{color:"#ccc",column:80,lineStyle:"dashed"}],N="",O=[{name:"default",loaded:!0},{name:"3024-day",loaded:!1},{name:"3024-night",loaded:!1},{name:"ambiance-mobile",loaded:!1},{name:"ambiance",loaded:!1},{name:"base16-dark",loaded:!1},{name:"base16-light",loaded:!1},{name:"blackboard",loaded:!1},{name:"cobalt",loaded:!1},{name:"eclipse",loaded:!1},{name:"elegant",loaded:!1},{name:"erlang-dark",loaded:!1},{name:"lesser-dark",loaded:!1},{name:"mbo",loaded:!1},{name:"midnight",loaded:!1},{name:"monokai",loaded:!1},{name:"mdn-like",loaded:!1},{name:"neat",loaded:!1},{name:"neo",loaded:!1},{name:"night",loaded:!1},{name:"paraiso-dark",loaded:!1},{name:"paraiso-light",loaded:!1},{name:"pastel-on-dark",loaded:!1},{name:"rubyblue",loaded:!1},{name:"solarized dark",fileName:"solarized",loaded:!1},{name:"solarized light",fileName:"solarized",loaded:!1},{name:"the-matrix",loaded:!1},{name:"tomorrow-night-eighties",loaded:!1},{name:"twilight",loaded:!1},{name:"vibrant-ink",loaded:!1},{name:"xq-dark",loaded:!1},{name:"xq-light",loaded:!1}],P={Ctrl:1,Alt:2,Cmd:3,Shift:4},Q=navigator.appVersion.indexOf("Mac")>=0;a("link").each(function(){var b="stylesheet"===a(this).attr("rel")?a(this).attr("href"):"",c=b.indexOf("/codemirror-custom");c>=0&&(N=b.substring(0,c))}),a.widget("apex.codeEditor",{version:"5.0",widgetEventPrefix:"codeEditor",options:{mode:"javascript",readOnly:!1,autofocus:!1,lineWrapping:null,wrapIndent:null,errors:[],warnings:[],usePlainTextArea:!1,theme:"default",indentUnit:4,tabSize:4,indentWithTabs:!1,lineNumbers:!0,ruler:!0,codeComplete:null,validateCode:null,queryBuilder:null,settingsChanged:null},_errorLineWidgets:[],_warningLineWidgets:[],wrappedTextArea:!1,settingsMenu$:null,_create:function(){var b,c,d,f,g=this.options;this.element.addClass(v),this.baseId=this.element[0].id||"aCE",null===g.lineWrapping&&("text/css"===g.mode||"text/html"===g.mode||"text/xml"===g.mode||"text/text"===g.mode?g.lineWrapping=!0:g.lineWrapping=!1),g.lineWrapping&&null===g.wrapIndent&&("text/css"===g.mode||"text/html"===g.mode||"text/xml"===g.mode?g.wrapIndent=!0:g.wrapIndent=!1),g.usePlainTextArea?(1===this.element.children("textarea").length?(this._textarea=this.element.children("textarea"),this._textarea.attr("wrap","soft").attr("autocorrect","off").attr("autocapitalize","off").attr("spellcheck","false"),this.textareaSavedStyle=this._textarea.attr("style")||"",this.wrappedTextArea=!0):(this._textarea=a("<textarea wrap='soft' autocorrect='off' autocapitalize='off' spellcheck='false' ></textarea>"),this.element.empty().append(this._textarea)),this.element.addClass(w),g.value!==e&&this._textarea.val(g.value),this._textarea.css({resize:"none",whiteSpace:g.lineWrapping?"pre-wrap":"pre",wordWrap:g.lineWrapping?"break-word":"normal"}),g.readOnly&&this._textarea.attr("readonly",!0),g.autofocus&&this._textarea[0].focus()):(b={mode:g.mode,theme:g.theme,lineWrapping:g.lineWrapping,indentUnit:g.indentUnit,tabSize:g.tabSize,indentWithTabs:g.indentWithTabs,readOnly:g.readOnly,autofocus:g.autofocus,lineNumbers:g.lineNumbers,styleActiveLine:!0,matchBrackets:!0,autoCloseBrackets:!0,autoCloseTags:!0,rulers:g.ruler?M:[],extraKeys:{"Ctrl-Space":"autocomplete",Tab:function(a){a.somethingSelected()?a.indentSelection("add"):g.indentWithTabs?a.replaceSelection("\t","end","+input"):a.replaceSelection(L.substring(0,g.tabSize),"end","+input")},"Shift-Tab":"indentLess"}},k(g.theme),1===this.element.children("textarea").length?(this.wrappedTextArea=!0,this._editor=CodeMirror.fromTextArea(this.element.children("textarea")[0],b),g.value&&this.setValue(g.value)):(this.element.empty(),b.value=g.value,this._editor=CodeMirror(this.element[0],b)),g.wrapIndent&&(c=this._editor.defaultCharWidth(),f=4,this._editor.on("renderLine",function(a,b,e){d=CodeMirror.countColumn(b.text,null,a.getOption("tabSize"))*c,e.style.textIndent="-"+d+"px",e.style.paddingLeft=f+d+"px"})),this._editor.refresh(),CodeMirror.commands.autocomplete=function(a){var b,c=a.doc.modeOption,d={};switch(c){case"text/javascript":b=CodeMirror.hint.javascript;break;case"text/css":b=CodeMirror.hint.css;break;case"text/html":b=CodeMirror.hint.html;break;case"text/xml":b=CodeMirror.hint.xml;break;case"text/x-plsql":b=l,d={async:!0,dataCallback:g.codeComplete}}b&&CodeMirror.showHint(a,b,d)},this._errorLineWidgets=[],this._warningLineWidgets=[],this._addMessages(this._errorLineWidgets,g.errors,"is-error"),this._addMessages(this._warningLineWidgets,g.warnings,"is-warning")),delete g.value,g.autofocus&&this.element.addClass(x),this._initToolbar(),this._initMessageBar(),this._editor?this._initSearchBar():this._makeNotificationMessage(),this._resize(),this._on(this._eventHandlers)},_eventHandlers:{resize:function(a){this._resize(),a.stopPropagation()},keydown:function(b){var c,d,e=a(b.target),f=b.which;"TEXTAREA"!==b.target.nodeName&&0===e.closest(I).length||(!this._textarea||f!==K.TAB||b.shiftKey||b.ctrlKey||b.altKey?117===f&&!b.ctrlKey&&b.altKey&&(b.shiftKey?this.element.children(H).find("button").last()[0].focus():(c=a(":tabbable"),d=c.index(this.element.find("textarea:tabbable")),d>=0&&d<c.length?d+=1:c.length>0&&(d=0),d>=0&&c[d].focus())):!this.options.readOnly&&g(this._textarea[0],this.options.indentWithTabs,this.options.tabSize)&&b.preventDefault())},focusin:function(a){this.element.addClass(x)},focusout:function(a){this.element.removeClass(x)}},_destroy:function(){this.element.find(H+","+D+","+z).remove(),this.element.removeClass(v+" "+w+" "+x),this.wrappedTextArea?this._editor?(a(this._editor.getWrapperElement()).remove(),a(this.element.find("textarea").show())):this._textarea&&this.textareaSavedStyle!==e&&this._textarea.attr("style",this.textareaSavedStyle):this.element.empty(),this.settingsMenu$&&this.settingsMenu$.remove()},_setOption:function(a,b){var c=this,d=this.options.usePlainTextArea;this._super(a,b),"errors"===a||"warnings"===a?this._textarea?this._makeNotificationMessage():"errors"===a?this._addMessages(this._errorLineWidgets,b,"is-error"):"warnings"===a&&this._addMessages(this._warningLineWidgets,b,"is-warning"):"readOnly"===a?(this._textarea?this._textarea.attr("readonly",b):this._editor.setOption(a,b),this._updateToolbarButtons()):"validateCode"===a||"queryBuilder"===a?(this.element.find(H).remove(),this._initToolbar()):"usePlainTextArea"===a&&b!==d?setTimeout(function(){var a=c.element,d=c.options,e=c.getValue();d.usePlainTextArea=b,c.element.codeEditor("destroy"),d.value=e,a.codeEditor(d)},10):"ruler"===a&&this._editor?this._editor.setOption("rulers",b?M:[]):this._editor&&("theme"===a&&k(b),this._editor.setOption(a,b))},setValue:function(a){this._textarea?this._textarea.val(a):this._editor.doc.setValue(a)},getValue:function(){return this._textarea?this._textarea.val():this._editor.doc.getValue()},focus:function(){this._textarea?this._textarea[0].focus():this._editor.focus()},setCursor:function(a,b){this._textarea?(h(this._textarea[0],a,b),this._textarea[0].focus()):this._editor.doc.setCursor(a,b)},showNotification:function(a){this.element.children(z).hide(),this.element.children(D).show().children(F).first().html(a),this._resize()},showSearchBar:function(b,c){var d;this._editor&&(d=1===this.element.children(z).filter(":visible").length,this.element.children(z).show().find(B).toggle(b),this.element.children(D).hide(),!d||c?a("#"+this.baseId+"_findText").val(c).focus():a("#"+this.baseId+"_findText").focus()[0].select(),this.lastSearchText=null,this._resize())},changeGeneration:function(){return this._textarea?(this._originalValue=this._textarea.val(),1):this._editor.doc.changeGeneration()},isClean:function(a){return this._textarea?this._textarea.val()===this._originalValue:this._editor.doc.isClean(a)},getSettingsString:function(){var b=this.options,c="|";return a.each(J,function(a,d){var e=b[d];"boolean"==typeof e&&(e=e.toString().substr(0,1)),c+=e+"|"}),c},_resize:function(){var c,d=this.element.height(),e=this.element.width(),f=this.element.children(H).outerHeight();this.element.children(z+","+D).filter(":visible").each(function(){f+=a(this).outerHeight()}),this._editor?(c=this.element.find(I),c.height(d-f),c.width(e),this._editor.refresh()):(b.setOuterHeight(this._textarea,d-f),b.setOuterWidth(this._textarea,e))},_validateCode:function(){var d=this.options.validateCode,e=this;d&&d(this.getValue(),function(d){d=a.extend({},{errors:[],warnings:[]},d),e._setOption("errors",d.errors),e._setOption("warnings",d.warnings),d.errors.length>0||d.warnings.length>0?(e._editor&&(e.element.children(D).hide().children(F).first().empty(),e._resize()),e.focus()):e.showNotification("<ul><li class='is-success'>"+b.escapeHTML(c.getMessage("CODE_EDITOR.VALIDATION_SUCCESS"))+"</li></ul>")})},_queryBuilder:function(){var a=this.options.queryBuilder;a&&a(this,this.getValue())},_addMessages:function(b,c,d){var e,f,g,h,i=Math.max(0,this._editor.doc.lineCount()-1),j=0,k=0;for(h=0;h<b.length;h++)this._editor.removeLineWidget(b[h]);for(b.length=0,h=0;h<c.length;h++)/^ORA-06550:/.test(c[h])?(e=c[h].match(/\d{1,}/g),j=parseInt(e[1],10)-1,k=parseInt(e[2],10)-1,isNaN(j)&&(j=0),isNaN(k)&&(k=0)):(j=0,k=0),f=a("<div></div>").addClass(d).text(c[h]),j>i?(g=!1,j=i):g=!0,b.push(this._editor.addLineWidget(j,f[0],{coverGutter:!1,noHScroll:!0,above:g,showIfHidden:!0})),0===h&&this._editor.doc.setCursor({line:j,ch:k})},_makeNotificationMessage:function(){var a,c="",d=this.options;if(d.errors.length>0||d.warnings.length>0){for(c="<ul>",a=0;a<d.errors.length;a++)c+="<li class='is-error'>"+b.escapeHTML(d.errors[a])+"</li>";for(a=0;a<d.warnings.length;a++)c+="<li class='is-warning'>"+b.escapeHTML(d.warnings[a])+"</li>";c+="</ul>",this.element.children(z).hide(),this.element.children(D).show().children(F).first().html(c),this._resize()}else this.element.children(D).is(":visible")&&(this.element.children(D).hide().children(F).first().empty(),this._resize())},_initToolbar:function(){function c(a,b,c,d,e,f){var g=i(j._editor,b);n(a,j.baseId+"_"+b,g,c,d,e,f)}function d(b){a("#"+j.baseId+"_"+b).click(function(){j._editor&&(j._editor.focus(),setTimeout(function(){j._editor.execCommand(b)},10))})}function e(){var a,b,c=[];for(a=0;a<O.length;a++)b=O[a],c.push({label:b.name.replace("-"," "),value:b.name});return c}function g(){return[{label:"2",value:"2"},{label:"3",value:"3"},{label:"4",value:"4"},{label:"8",value:"8"}]}function h(){var b=j.element[0];j._trigger("settingsChanged",a.Event("click",{target:b}))}var j=this,k=this.options,l=b.htmlBuilder();l.markup("<div class='"+G+"'>"),c(l,"undo","icon-undo",f("CODE_EDITOR.UNDO"),"a-Button--pillStart",!!k.usePlainTextArea),c(l,"redo","icon-redo",f("CODE_EDITOR.REDO"),"a-Button--pillEnd a-Button--gapRight",!!k.usePlainTextArea),c(l,"find","icon-cm-find",f("CODE_EDITOR.FIND"),"a-Button--pillStart",!!k.usePlainTextArea),c(l,"replace","icon-cm-replace",f("CODE_EDITOR.REPLACE"),"a-Button--pillEnd a-Button--gapRight",!!k.usePlainTextArea),k.queryBuilder&&c(l,"queryBuilder","icon-cm-query-builder",f("CODE_EDITOR.QUERY_BUILDER"),null,!1),c(l,"autocomplete","icon-cm-autocomplete",f("CODE_EDITOR.HINT"),null,!!k.usePlainTextArea),k.validateCode&&c(l,"validate","icon-cm-validate",f("CODE_EDITOR.VALIDATE"),null,!1),l.markup("<button").attr("id",this.baseId+"_settings").attr("title",f("CODE_EDITOR.SETTINGS")).attr("aria-label",f("CODE_EDITOR.SETTINGS")).attr("data-menu",this.baseId+"_settingsMenu").markup(" class='a-Button a-Button--noLabel a-Button--iconTextButton js-menuButton u-pullRight' type='button' aria-haspopup='true' aria-expanded='false'>").markup("<span class='a-Icon icon-gear' aria-hidden='true'></span><span class='a-Icon icon-menu-drop-down' aria-hidden='true'></span></button>").markup("</div>"),this.element.prepend(l.toString()),d("undo"),d("redo"),d("find"),d("replace"),d("autocomplete"),k.validateCode&&a("#"+j.baseId+"_validate").click(function(){j._validateCode()}),k.queryBuilder&&a("#"+j.baseId+"_queryBuilder").click(function(){j._queryBuilder()}),this.settingsMenu$=a(b.htmlBuilder().markup("<div style='display:none'").attr("id",this.baseId+"_settingsMenu").markup("></div>").toString()).appendTo("body"),this.settingsMenu$.menu({items:[{type:"toggle",labelKey:"CODE_EDITOR.USE_PLAIN_TEXT_EDITOR",get:function(){return k.usePlainTextArea},set:function(a){j._setOption("usePlainTextArea",a),h()}},{type:"toggle",labelKey:"CODE_EDITOR.INDENT_WITH_TABS",get:function(){return!k.indentWithTabs},set:function(a){j._setOption("indentWithTabs",!a),h()}},{type:"subMenu",labelKey:"CODE_EDITOR.TAB_SIZE",disabled:function(){return k.usePlainTextArea&&k.indentWithTabs},menu:{items:[{type:"radioGroup",get:function(){return""+k.tabSize},set:function(a){j._setOption("tabSize",parseInt(a,10)),h()},choices:g()}]}},{type:"subMenu",labelKey:"CODE_EDITOR.INDENT_SIZE",disabled:function(){return k.usePlainTextArea},menu:{items:[{type:"radioGroup",get:function(){return""+k.indentUnit},set:function(a){j._setOption("indentUnit",parseInt(a,10)),h()},choices:g()}]}},{type:"subMenu",labelKey:"CODE_EDITOR.THEMES",disabled:function(){return k.usePlainTextArea},menu:{items:[{type:"radioGroup",get:function(){return k.theme},set:function(a){j._setOption("theme",a),h()},choices:e()}]}},{type:"toggle",labelKey:"CODE_EDITOR.SHOW_LINE_NUMBERS",disabled:function(){return k.usePlainTextArea},get:function(){return k.lineNumbers},set:function(a){j._setOption("lineNumbers",a),h()}},{type:"toggle",labelKey:"CODE_EDITOR.SHOW_RULER",disabled:function(){return k.usePlainTextArea},get:function(){return k.ruler},set:function(a){j._setOption("ruler",a),h()}}]}),this._editor&&this._editor.on("change",function(){j._updateToolbarButtons()}),this._updateToolbarButtons()},_updateToolbarButtons:function(){var b={undo:0,redo:0},c=this.options,d=c.usePlainTextArea||c.readOnly;this._editor&&(b=this._editor.historySize()),a("#"+this.baseId+"_replace")[0].disabled=d,a("#"+this.baseId+"_autocomplete")[0].disabled=d,c.validateCode&&(a("#"+this.baseId+"_validate")[0].disabled=c.readOnly),c.queryBuilder&&(a("#"+this.baseId+"_queryBuilder")[0].disabled=c.readOnly),a("#"+this.baseId+"_undo")[0].disabled=0===b.undo,a("#"+this.baseId+"_redo")[0].disabled=0===b.redo},_initMessageBar:function(){var c=this,d=b.htmlBuilder(),e=this.baseId+"_mClose";d.markup("<div class='"+C+"' style='display:none;'><div class='"+E+"'></div>"),n(d,e,null,"ui-icon-closethick",f("CODE_EDITOR.CLOSE"),"a-Button--small a-CodeEditor-searchBar-closeButton",!1),d.markup("</div>"),this.element.children(H).after(d.toString()),a("#"+e).click(function(){a(this).parent().hide(),c._resize()})},_initSearchBar:function(){function c(b){a("#"+g.baseId+"_"+b).click(function(){g._editor.focus(),setTimeout(function(){g._editor.execCommand(b)},10)})}function d(){g.element.children(z).hide(),g._resize(),g.focus(),g._editor.execCommand("clearSearch")}function e(){g._editor.setSearchState(a("#"+h).val(),a("#"+l)[0].checked,!a("#"+k)[0].checked)}var g=this,h=this.baseId+"_findText",j=this.baseId+"_replaceText",k=this.baseId+"_caseCb",l=this.baseId+"_reCb",o=this.baseId+"_sClose",p=b.htmlBuilder();p.markup("<div class='"+y+"' style='display:none;'><label class='a-CodeEditor-searchBar-label'").attr("for",h).markup(">").content(f("CODE_EDITOR.FIND_INPUT")).markup("</label><input class='a-CodeEditor-searchBar-textInput' type='text'").attr("id",h).markup(">"),n(p,g.baseId+"_findNext",i(g._editor,"findNext"),"icon-down-chevron",f("CODE_EDITOR.FIND_NEXT"),"a-Button--small a-Button--pillStart"),n(p,g.baseId+"_findPrev",i(g._editor,"findPrev"),"icon-up-chevron",f("CODE_EDITOR.FIND_PREV"),"a-Button--small a-Button--pillEnd"),p.markup("<div class='a-CodeEditor-searchBar-checkboxGroup'><input type='checkbox'").attr("id",k).markup("><label class='a-CodeEditor-searchBar-label'").attr("for",k).markup(">").content(f("CODE_EDITOR.MATCH_CASE")).markup("</label><input type='checkbox'").attr("id",l).markup("><label class='a-CodeEditor-searchBar-label'").attr("for",l).markup(">").content(f("CODE_EDITOR.MATCH_RE")).markup("</label></div><div class='"+A+"'><label class='a-CodeEditor-searchBar-label'").attr("for",j).markup(">").content(f("CODE_EDITOR.REPLACE_INPUT")).markup("</label><input class='a-CodeEditor-searchBar-textInput' type='text'").attr("id",j).markup(">"),m(p,g.baseId+"_replaceNext",null,f("CODE_EDITOR.REPLACE"),"a-Button--small a-Button--pillStart"),m(p,g.baseId+"_replaceAll",null,f("CODE_EDITOR.REPLACE_ALL"),"a-Button--small a-Button--pill"),m(p,g.baseId+"_replaceSkip",null,f("CODE_EDITOR.REPLACE_SKIP"),"a-Button--small a-Button--pillEnd"),p.markup("</div>"),n(p,o,null,"ui-icon-closethick",f("CODE_EDITOR.CLOSE"),"a-Button--small a-CodeEditor-searchBar-closeButton",!1),p.markup("</div>"),this.element.children(H).after(p.toString()),this.element.children(z).keydown(function(b){b.which===a.ui.keyCode.ESCAPE&&(b.preventDefault(),d())}),c("findNext"),c("findPrev"),a("#"+g.baseId+"_replaceSkip").click(function(){g._editor.focus(),setTimeout(function(){g._editor.execCommand("findNext")},10)}),a("#"+g.baseId+"_replaceNext").click(function(){g._editor.focus(),setTimeout(function(){g._editor.doReplace(a("#"+j).val(),!1)},10)}),a("#"+g.baseId+"_replaceAll").click(function(){g._editor.focus(),setTimeout(function(){g._editor.doReplace(a("#"+j).val(),!0)},10)}),a("#"+o).click(d),g.lastSearchText=null,a("#"+h).keydown(function(b){var c,d=b.which;d!==a.ui.keyCode.ENTER&&d!==a.ui.keyCode.DOWN&&d!==a.ui.keyCode.UP||(b.preventDefault(),c=a(this).val(),c!==g.lastSearchText&&(e(),g.lastSearchText=c),setTimeout(function(){g._editor.execCommand(d===a.ui.keyCode.UP?"findPrev":"findNext")},10))}).blur(function(a){e()}),a("#"+l+",#"+k).click(function(){e()})}}),a.apex.codeEditor.optionsFromSettingsString=function(b){var c=b.split("|"),e={};return c.length!==J.length+2?(b.length>0&&d.warn("CodeEditor: Bad input ignored:",b),e):(c=c.splice(1,J.length+1),a.each(J,function(a,b){var f=c[a],g=b;if("theme"===g){if(!j(f))return void d.warn("CodeEditor: Bad theme ignored: "+f)}else if("indentUnit"===g||"tabSize"===g){if(f=parseInt(f,10),isNaN(f))return void d.warn("CodeEditor: Bad number ignored: "+f)}else if("t"===f)f=!0;else{if("f"!==f)return void d.warn("CodeEditor: Bad Boolean ignored: "+f);f=!1}e[g]=f}),e)},CodeMirror.defineExtension("setSearchState",function(a,b,c){var d=this,e=q(this);return!a&&e.query?void t(this):void this.operation(function(){b?(a=new RegExp(a,c?"i":""),a.test("")&&(a=/x^/)):""===a&&(a=/x^/),e.query=a,e.isCaseInsensitive=c,d.removeOverlay(e.overlay,c),e.overlay=o(e.query,c),d.addOverlay(e.overlay),e.posFrom=e.posTo=d.getCursor()})}),CodeMirror.defineExtension("doReplace",function(a,b){function c(a,b){return e[b]}var d,e,f=this,g=q(this);b?this.operation(function(){for(d=f.getSearchCursor(g.query,CodeMirror.Pos(f.firstLine(),0),g.isCaseInsensitive);d.findNext();)"string"!=typeof g.query?(e=f.getRange(d.from(),d.to()).match(g.query),d.replace(a.replace(/\$(\d)/g,c))):d.replace(a)}):this.operation(function(){d=f.getSearchCursor(g.query,g.posFrom,g.isCaseInsensitive),d.atOccurrence||d.findNext(),"string"!=typeof g.query?(e=f.getRange(d.from(),d.to()).match(g.query),d.replace(a.replace(/\$(\d)/g,c))):d.replace(a),s(f)})}),CodeMirror.commands.find=function(a){t(a),r(a)},CodeMirror.commands.findNext=r,CodeMirror.commands.findPrev=function(a){r(a,!0)},CodeMirror.commands.clearSearch=t,CodeMirror.commands.replace=u,CodeMirror.commands.replaceAll=u}(apex.jQuery,apex.util,apex.lang,apex.debug);