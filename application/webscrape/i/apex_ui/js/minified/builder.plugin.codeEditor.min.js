!function(a,b,c,d){"use strict";a.codeEditor=function(a,e){var f,g,h=d(a),i=h.children("textarea");h.height(i.height()+80),e.validate&&!e.readOnly&&(f=function(a,c){b.plugin(e.ajaxIdentifier,{x01:"validate",x02:e.appId,x09:""===e.itemRemoteDB?null:$v(e.itemRemoteDB),p_clob_01:a},{success:function(a){c("OK"===a.result?{errors:[]}:{errors:[a.result]})}})}),e.queryBuilder&&(g=function(a,b){e.itemRemoteDB&&""!==e.itemRemoteDB?apex.message.alert(apex.lang.formatMessage("WWV_FLOW_BUILDER.REMOTESQL.QUERY_BUILDER_NOT_SUPPORTED")):apex.navigation.popup({url:apex.util.makeApplicationUrl({appId:4500,pageId:1002,clearCache:1002,itemNames:["P1002_RETURN_INTO","P1002_POPUP","P1002_SCHEMA"],itemValues:[a.baseId,"1",e.parsingSchema]}),width:950,height:720})}),h.codeEditor(d.extend({mode:e.mode,readOnly:e.readOnly,codeComplete:function(a,c){""===$v(e.itemRemoteDB)?b.plugin(e.ajaxIdentifier,{p_widget_name:a.type,x01:"hint",x02:e.appId,x03:a.search,x04:a.parent,x05:a.grantParent},{success:c}):console.log(apex.lang.formatMessage("WWV_FLOW_BUILDER.REMOTESQL.CODE_COMPLETION_NOT_SUPPORTED"))},validateCode:f,queryBuilder:(!e.itemRemoteDB||""===e.itemRemoteDB)&&g,settingsChanged:function(){var a=d(this).codeEditor("getSettingsString");b.plugin(e.ajaxIdentifier,{x01:"save",x02:e.appId,x03:a},{queue:{name:"codeEditor_save_settings",action:"lazyWrite"},dataType:""})}},d.apex.codeEditor.optionsFromSettingsString(e.settings||""))),e.adjustableHeight&&(h.wrap("<div class='a-CodeEditor--resizeWrapper'></div>").parent().resizable({handles:"s",helper:"a-CodeEditor--resizeHelper"}).on("resizestop",function(a,b){var c=d(this),e=d(this).children().eq(0);c.width(c.width()+1),e.height(c.height()-2),e.width(c.width()),e.trigger("resize")}),h.parent().find(".ui-resizable-handle.ui-resizable-s").attr("tabindex",0).on("keydown",function(a){if(a.which===d.ui.keyCode.UP||a.which===d.ui.keyCode.DOWN){var b,c,e=d(this).parent();c=e.width()-1,a.which===d.ui.keyCode.UP?(b=e.height()-10,b<100&&(b=100)):(b=e.height()+10,b>1e3&&(b=1e3)),e.width(c),e.height(b).trigger("resizestop"),a.preventDefault()}})),i[0].id&&c.initPageItem(i[0].id,{show:function(){h.show()},hide:function(){h.hide()},setValue:function(a,b){h.codeEditor("setValue",a)},getValue:function(){return h.codeEditor("getValue")},setFocusTo:function(){return h.codeEditor("focus"),{focus:function(){}}}})},a.codeEditor.saveProcess=function(a,c,e,f){var g,h=f?d.extend(!0,{},f):{};if(g=d(a).codeEditor("getValue"),g.length<=4e3)h[e]=g;else{for(h[e]=[];g.length>4e3;)h[e].push(g.substr(0,4e3)),g=g.substr(4e3);h[e].push(g.substr(0,4e3))}return b.process(c,h,{dataType:"",loadingIndicator:a,loadingIndicatorPosition:"page"})},a.codeEditor.saveSubmit=function(a,b,c){function e(a){h.append("<input type='hidden' name='"+b+"' value = '"+apex.util.escapeHTML(a)+"'>")}var f,g=c.form||"wwv_flow",h=d("form[name="+g+"]",apex.gPageContext$);if(f=d(a).codeEditor("getValue"),f.length<=4e3)e(f);else{for(;f.length>4e3;)e(f.substr(0,4e3)),f=f.substr(4e3);e(f.substr(0,4e3))}apex.page.submit(c)},d(function(){d(document.body).on("codeeditorsettingschanged",function(a){var b=d(a.target),c=d.apex.codeEditor.optionsFromSettingsString(b.codeEditor("getSettingsString"));d(".a-CodeEditor").each(function(){this!==a.target&&d(this).codeEditor("option",c)})}),d(window).on("apexwindowresized",function(){d(".a-CodeEditor").not(".resize").each(function(){var a,b=d(this).parent();b.hasClass("a-CodeEditor--resizeWrapper")&&(a=b.parent().width(),b.width(a),d(this).width(a)),d(this).trigger("resize")})})})}(apex.builder.plugin,apex.server,apex.widget,apex.jQuery);