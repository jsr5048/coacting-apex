!function(a,b,c,d){"use strict";function e(b,d){var e='<li class="a-AlertMessages-item" data-typeid="#TYPEID#" data-componentid="#COMPONENTID#" data-propertyid="#PROPERTYID#">  <a href="#" class="a-MediaBlock a-AlertMessages-message">    <div class="a-MediaBlock-graphic">      <span class="#ICON_CLASS#"></span>    </div>    <div class="a-MediaBlock-content">      <h5 class="a-AlertMessages-propertyTitle">#COMPONENT_TYPE# &rarr; #COMPONENT# &rarr; #DISPLAY_GROUP# &rarr; #PROPERTY#</h5>      <p class="a-AlertMessages-messageDescription"><pre>#VALUE#</pre></p>    </div>  </a></li>',f=b.component,i=b.getMetaData(),j=b.getDisplayValue();return j=c.escapeHTML(j.replace(d,"~~peSearchHitBegin~~$&~~peSearchHitEnd~~")),j=j.replace(/~~peSearchHitBegin~~/g,'<span class="a-Search-term">').replace(/~~peSearchHitEnd~~/g,"</span>"),e.replace(/#CSS_CLASS#/g,g.WARNING).replace(/#ICON_CLASS#/g,h.SEARCH).replace("#TYPEID#",f.typeId).replace("#COMPONENTID#",f.id).replace("#PROPERTYID#",b.id).replace("#COMPONENT_TYPE#",c.escapeHTML(a.getComponentType(f.typeId).title.singular)).replace("#COMPONENT#",c.escapeHTML(f.getDisplayTitle())).replace("#DISPLAY_GROUP#",c.escapeHTML(a.getDisplayGroup(i.displayGroupId).title)).replace("#PROPERTY#",c.escapeHTML(i.prompt)).replace("#VALUE#",j)}var f="search_",g={WARNING:"warning"},h={SEARCH:"a-Icon icon-search",WARNING:"icon-warning-sign"},i=null;b.widget("apex.peSearch",{options:{},_create:function(){var c,d=this;this.element.empty(),c=b("<div>",{"class":"a-AlertMessages"}).appendTo(this.element),this._container$=b("<ul></ul>",{"class":"a-AlertMessages-list"}).appendTo(c).on("click","a",this._goToComponent),b(document).on("modelReady",function(){a.observer(f+this.uuid,{events:[a.EVENT.CHANGE,a.EVENT.DELETE,a.EVENT.REMOVE_PROP]},function(a){d._update(a)}),b(document).one("modelCleared",function(){d._container$.empty(),i=null})})},_init:function(){},_destroy:function(){this.element.empty(),b(document).off("modelReady"),b(document).off("modelCleared"),a.unobserver(f+this.uuid)},search:function(b){function f(b,c){var d,g,h,i,j="";for(d=a.fullTextSearch(c,{typeId:b}),h=0,i=d.length;h<i;h++)j+=e(d[h],c);for(g=a.getComponentType(b),h=0,i=g.childComponentTypes.length;h<i;h++)j+=f(g.childComponentTypes[h],c);return j}i=b instanceof RegExp?b:""!==b&&b!==d?new RegExp(c.escapeRegExp(b),"gi"):null,this._container$.empty(),null!==i&&this._container$.append(f(a.COMP_TYPE.PAGE,i))},clear:function(){i=null,this._container$.empty()},_update:function(c){var d,f,g=i,h=c.component,j="li[data-typeid='"+h.typeId+"'][data-componentid='"+h.id+"']";if(null!==g)if(b.inArray(a.EVENT.DELETE,c.events)>=0)this._container$.find(j).remove();else for(var k in c.properties)c.properties.hasOwnProperty(k)&&(d=this._container$.find(j+"[data-propertyid='"+k+"']"),b.inArray(a.EVENT.REMOVE_PROP,c.properties[k])>=0?d.remove():b.inArray(a.EVENT.CHANGE,c.properties[k])>=0&&d.length>0&&(f=[c.component.getProperty(k)],f=a.fullTextSearch(g,{properties:f}),f.length>0?d.replaceWith(e(f[0],g)):d.remove()))},_goToComponent:function(c){var d=b(this).closest("li"),e=a.getComponents(d.data("typeid"),{id:d.data("componentid")})[0];window.pageDesigner.goToComponent(e.typeId,e.id,d.data("propertyid"))}})}(pe,apex.jQuery,apex.util);