!function(a,b,c,d){"use strict";function e(a,b,c,d){a.markup("<span").attr("class",b+" "+c).optionalAttr("style",d).markup("></span>")}function f(){var a,b,c,e,f;for(y?(e=d(y),f=null):(e=F,f=G),l({$menu:B[0],subMenu:!1,x:e,y:f,slide:!1}),a=1;a<B.length;a++)b=B[a],c=b.parents(ia).eq(0),l({$menu:b,subMenu:!0,x:c,slide:!1})}function g(){d(S).each(function(){d(this).menu("resize")})}function h(){D||(D=!0,d(window).on("blur.menuTracking",function(){Sa.closeAll(!0)}),d("html").on("mousedown.menuTracking",function(a){var b=d(a.target);0!==b.closest(V).length||y&&0!==b.closest(y).length||Sa.closeAll(!0)}).on("mousemove.menuTracking",function(a){var b,c;J===a.pageX&&K===a.pageY||(J=a.pageX,K=a.pageY,b=d(a.target),c=b.parents(V)[0],!c&&w&&(c=b.parent(S)[0]),!c&&O&&O!==c&&d(O).focus(),O=c)}),apex.tooltipManager&&(apex.tooltipManager.disableTooltips(),Q=!0))}function i(){d(window).off(".menuTracking"),d("html").off(".menuTracking"),D=!1,apex.tooltipManager&&Q&&(apex.tooltipManager.enableTooltips(),Q=!1)}function j(a){return a.children().children($)}function k(){var a;y&&(a=d(y),a.is(ia)?a.find(Ha).focus():a.focus())}function l(b){var c,f,g,h,i,k=b.$menu,l={},m="none"!==k.css("display");m||k.css({display:"block",position:"absolute",top:-99999,left:0}),b.minWidth&&k.css("min-width",b.minWidth),"true"!==k.attr("data-custom")&&(i=k.find("li").first().outerHeight(),g=d(window).height(),h=g>1e3?.6:g>500?.75:.9,g=Math.floor(g*h/i)*i-i,f=k.height(),f>g?(0===j(k).length&&(c=a.htmlBuilder(),c.markup("<div").attr("class",_+"  "+ca).markup(">"),e(c,Ka,ea),c.markup("</div>"),k.children().first().addClass(ba).prepend(c.toString()).append(c.toString().replace(ea,fa).replace(ca,da)).children("ul").first().wrap("<div class='"+Z+"'></div>")),j(k).height(g)[0].scrollTop=0,k.find(aa+"."+ca).addClass(Da)):j(k).length>0&&(k.children().first().removeClass(ba).children(aa).remove(),k.find("ul").first().unwrap())),"number"==typeof b.x&&"number"==typeof b.y?(F=b.x,G=b.y,l.of=d.Event("click",{pageX:F,pageY:G})):(F=G=null,l.of=b.x),x?b.subMenu?(l.my="right top",l.at="left top"):(l.my="right top",l.at="right bottom"):b.subMenu?(l.my="left top",l.at="right top"):(l.my="left top",l.at="left bottom"),l.collision="flipfit flipfit",k.position(l),k.css("display",m?"block":"none"),m||(b.slide?k.slideDown(200):k.show(),b.focus&&k.focus())}function m(a){return a.parent().parent().hasClass(R)}function n(a,b){var c=null;return d.each(a.items,function(a,d){return d.id===b?(c=d,!1):("subMenu"!==d.type||(c=n(d.menu,b),null===c))&&void 0}),c}function o(a){var b=null,c=a.search(/_c[0-9]+$/);return c>=0&&(b=1*a.substring(c+2)),b}function p(a,c,e,f,g,h){function i(){var e;d(document.body).on("dialogopen.menu",function(a){var b=d(a.target);e=!0,b.dialog("option","modal")&&b.on("dialogclose.menu",function(a){b.off("dialogclose.menu"),k()})}),setTimeout(function(){d(document.body).off("dialogopen.menu")},150),"string"==typeof a.action&&c?(b.info("Invoke action menu item '"+(a.label||c.lookup(a.action).label)+"'"),z=c.invoke(a.action,{},y)||!1):(b.info("Invoke action menu item '"+a.label+"'"),a.action?z=a.action(f,y)||!1:a.href&&(apex.navigation.redirect(a.href),z=!0)),e&&(z=!0)}var j,l=!1,m=g||a.type;try{if("toggle"===m)"string"==typeof a.action&&c&&(a=c.lookup(a.action),l=!0),j=!a.get(),b.info("Invoke toggle menu item '"+(a.label||(j?a.onLabel:a.offLabel))+"' value now "+j),a.set(j),l&&c.update(a.name),A=!0;else if("radioGroup"===m)"string"==typeof a.action&&c&&(a=c.lookup(a.action),l=!0),j=a.choices[e].value,b.info("Invoke choice menu item '"+a.choices[e].label+"' value now "+j),a.set(j),l&&c.update(a.name),A=!0;else if("action"===m)h?setTimeout(function(){i()},210):i(),A=!0;else if("subMenu"===m)return!1}catch(n){b.error("Error in menu action.",n)}return!0}function q(a,b){var c,d;if(a.menu&&a.menu.items)for(c=0;c<a.menu.items.length;c++)if(d=a.menu.items[c],d.current||q(d,b))return b&&d.current&&delete d.current,!0;return!1}function r(a){a.labelKey&&(a.label=c.getMessage(a.labelKey)),a.onLabelKey&&(a.onLabel=c.getMessage(a.onLabelKey)),a.offLabelKey&&(a.offLabel=c.getMessage(a.offLabelKey))}function s(a){a.is(Ha)?a.focus():a.find(Ha).first().focus()}function t(a){var b,c;return b=a.closest(ha)[0],c=a.find(ha).not(function(a,c){var e=d(c).parent().closest(ha)[0];return e!==b})}function u(a){var b=a.children(va);return 0===b.length&&(b=a.children(ja).find(va)),b}var v=null,w=null,x=!1,y=null,z=!1,A=!1,B=[],C=[],D=!1,E=!1,F=null,G=null,H=0,I=0,J=0,K=0,L=null,M=null,N=null,O=null,P=null,Q=!1,R="a-MenuBar",S=".a-MenuBar",T="a-MenuBar--tabs",U="a-Menu",V=".a-Menu",W="a-Menu--top",X="a-Menu-content",Y="."+X,Z="a-Menu-scroll",$=".a-Menu-scroll",_="a-Menu-scrollBtn",aa=".a-Menu-scrollBtn",ba="a-Menu--scrollable",ca="a-Menu-scrollBtn--up",da="a-Menu-scrollBtn--down",ea="icon-menu-scroll-up",fa="icon-menu-scroll-down",ga="a-Menu-item",ha="."+ga,ia=".a-Menu-item, .a-MenuBar-item",ja=".a-Menu-inner",ka=".a-Menu-item, .a-MenuBar-item, .a-Menu-content",la=ka+", "+aa,ma="a-Menu-item--default",na="a-MenuBar-item",oa="a-MenuBar-item--overflow",pa="a-MenuBar--overflow",qa="a-Menu-statusCol",ra="a-Menu-label",sa="a-Menu-accel",ta="a-MenuBar-label",ua=".a-Menu-label",va=".a-Menu-label,.a-MenuBar-label",wa="a-Menu-subMenuCol",xa=".a-Menu-subMenuCol",ya="a-Menu--split",za="a-Menu--current",Aa="a-Menu-hSeparator",Ba="a-Menu-itemSep",Ca=".a-Menu-itemSep",Da="is-disabled",Ea="is-focused",Fa="is-active",Ga=".is-focused",Ha="a, button, .a-Menu-label, .a-MenuBar-label",Ia="is-expanded",Ja=".is-expanded",Ka="a-Icon",La="button.js-menuButton",Ma="u-RTL",Na="aria-expanded",Oa="aria-disabled",Pa="aria-haspopup",Qa="aria-checked",Ra=d.ui.keyCode;d(function(){d(window).on("apexwindowresized",function(){g(),D&&f()})});var Sa={openMenu:function(a,b,c,e,f,g){var i=0;this.closeAll(),v=a[0],w=b?b[0]:null,x=d(w||v).hasClass(Ma),y="object"==typeof c&&c.get?c[0]:null,z=!1,A=!1,E=!0,0===B.length&&h(),B.push(a),E=!1,C=[],b&&(c.addClass(Ia).children(va).attr(Na,"true"),i=c.outerWidth()),l({$menu:a,subMenu:!1,x:c,y:e,slide:f,focus:g,minWidth:i})},isCurrentMenu:function(a){return v&&v===a},isCurrentMenuBar:function(a){return w&&w===a},isMenuOpen:function(a){var b;for(b=0;b<B.length;b++)if(B[b]===a)return!0;return!1},openSubMenu:function(a,b,c,d,e){this.closeOpenSiblings(a,c),B.push(b),l({$menu:b,subMenu:!0,x:a,slide:d,focus:e}),a.addClass(Ia).children(ja).find(va).attr(Na,"true")},closeOpenSiblings:function(a,b){var c=a.parent().find(Ja);for(b&&(E=!0);c.length>0;)this.closeLast(!1),c=a.parent().find(Ja);E=!1},closeLast:function(a){var b,c,e;B.length>0?(b=B.pop(),c=b.parents(ia).eq(0),c.length>0&&(e=u(c),c.removeClass(Ia).children(ja),e.attr(Na,"false"),a&&c.find(Ha).eq(0).focus()),b.hide(),0===B.length&&(!y||z||E||setTimeout(function(){k()},10),w&&(e=u(d(v).find(Ja)),d(v).find(Ja).removeClass(Ia),e.attr(Na,"false")),(w||v)&&d(w||v).data("apex-menu")._trigger("afterClose",{},{actionTookFocus:z,actionTaken:A,launcher:y}),v=null,E||(w=null,i()))):(v=null,w=null,i())},closeAll:function(a){for(;B.length>0;)this.closeLast(!1);a&&(v=null,w=null,i())}};d.widget("apex.menu",{version:"5.0",widgetEventPrefix:"menu",options:{menubar:!1,menubarShowSubMenuIcon:null,menubarOverflow:!1,iconType:Ka,behaveLikeTabs:!1,tabBehavior:"EXIT",useLinks:!0,slide:!1,firstItemIsDefault:!1,actionsContext:null,items:null,idPrefix:null,customContent:!1,asyncFetchMenu:null,beforeOpen:null,afterClose:null},isActive:!1,scrollTimerId:null,forwardKey:Ra.RIGHT,backwardKey:Ra.LEFT,actionsContext:null,_create:function(){var a,c,e=this.options,f=this.element;if(e.menubar&&e.customContent)throw new Error("Menubar cannot have custom content");if(apex.actions&&(this.actionsContext=e.actionsContext||apex.actions),e.items||e.customContent===!0||(e.items=this._parseMenuMarkup(f,e.menubar).items),!e.menubar&&(e.customContent||e.asyncFetchMenu)||e.items&&0!==e.items.length||b.error("Menu has no menu items"),"rtl"===f.css("direction")&&(f.addClass(Ma),e.menubar||f.attr("dir","rtl"),this.forwardKey=Ra.LEFT,this.backwardKey=Ra.RIGHT),f.attr("tabindex",-1).attr("role",e.menubar?"menubar":"menu").addClass(e.menubar?R:U),e.menubar){if(e.menubarOverflow&&f.addClass(pa),null===e.menubarShowSubMenuIcon)for(e.menubarShowSubMenuIcon=!1,a=0;a<e.items.length;a++)if("subMenu"!==e.items[a].type){e.menubarShowSubMenuIcon=!0;break}this.refresh(),e.behaveLikeTabs&&f.addClass(T),e.firstItemIsDefault&&b.warn("Invalid options for menu bar ignored")}else d("body").append(f),f.hide(),(e.menubarOverflow||e.menubarShowSubMenuIcon||e.behaveLikeTabs)&&b.warn("Invalid options for popup menu ignored");"onwheel"in f[0]||!this._eventHandlers.wheel||(c=void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",this._eventHandlers[c]=this._eventHandlers.wheel,delete this._eventHandlers.wheel),this._on(this._eventHandlers)},_eventHandlers:{mousedown:function(a){var b,c,e,f;1!==a.which||a.shiftKey||a.ctrlKey||(f=d(a.target).closest(la),a.preventDefault(),f.length>0&&!f.hasClass(X)&&!f.hasClass(Da)&&(f.is(aa)?(f.addClass(Fa),this._startScrolling(f.closest(V),f.hasClass(ca))):m(f)&&(c=f[0].id,b=this._getMenuItemFromId(c),"subMenu"===b.type&&(e=0!==d(a.target).closest(xa).length,(e||!b.action&&!b.href)&&this.toggle(f)))))},mouseup:function(a){var b,c,e,f,g,h,i;1!==a.which||a.shiftKey||a.ctrlKey||(i=d(a.target).closest(ka),a.preventDefault(),i.length>0&&!i.hasClass(X)&&(e=i[0].id,b=this._getMenuItemFromId(e),g=b.type,f=m(i),"subMenu"===g&&f&&(h=0!==d(a.target).closest(xa).length,h||!b.action&&!b.href||(g="action",Sa.closeOpenSiblings(i,f))),"subMenu"===g&&f||!i.is(ia)||i.hasClass(Da)||"display"===g||(c=o(e),p(b,this.actionsContext,c,this.options,g)&&Sa.closeAll())))},click:function(a){var b,c,e,f;return"A"===a.target.nodeName&&(1!==a.which||a.shiftKey||a.ctrlKey)?void(this.keyboardActivate=!1):(a.preventDefault(),void(this.keyboardActivate&&(this.keyboardActivate=!1,b=d(a.target).closest(ka),b.length>0&&!b.hasClass(X)&&(c=b[0].id,e=this._getMenuItemFromId(c),b.is(ia)&&!b.hasClass(Da)&&(f=o(c),p(e,this.actionsContext,f,this.options,"subMenu"===e.type?"action":e.type)&&Sa.closeAll())))))},mousemove:function(a){function b(){var a=f.parent().find(Ja);a.length>0&&!M&&(a.removeClass(Ia),N=a.find(V)[0],M=setTimeout(function(){a.addClass(Ia),M=null,N=null,Sa.closeOpenSiblings(f,c)},250))}var c,e,f,g,h=this;if(H!==a.pageX||I!==a.pageY){if(H=a.pageX,I=a.pageY,e=d(a.target),M&&e.closest(V)[0]===N&&(d(N).parent().addClass(Ia),N=null,clearTimeout(M),M=null),f=e.closest(Ca),f.length>0&&f[0]!==P)return L&&(clearTimeout(L),L=null),c=m(f),b(),P=f[0],g=e.closest(V).eq(0),void(g.length>0&&!g.hasClass(Ea)&&g.focus());if(f=e.closest(ia),f.length>0){if(!f.hasClass(Ea)&&"true"!==u(f).attr(Na)){if(L&&(clearTimeout(L),L=null),c=m(f),c&&D?(clearTimeout(M),M=null,Sa.closeOpenSiblings(f,c)):b(),this.options.menubar&&!Sa.isCurrentMenuBar(this.element[0])&&!this.isActive)return this.element.find(Ga).removeClass(Ea),void f.addClass(Ea);s(f),!f.hasClass(Da)&&f.find(V).length>0&&"true"!==u(f).attr(Na)&&(c?Sa.isCurrentMenuBar(this.element[0])&&this.open(f):L=setTimeout(function(){L=null,Sa.openSubMenu(f,f.children(V).first(),c,h.options.slide,!0)},300))}P=f[0]}else e.closest(V).first().focus()}},mouseleave:function(a){L&&(clearTimeout(L),L=null),this.options.menubar&&(Sa.isCurrentMenuBar(this.element[0])||this.isActive||this.element.find(Ga).removeClass(Ea))},wheel:function(a){var b,c=d(a.target).closest(V),e=a.originalEvent.deltaY||a.originalEvent.detail||-.025*a.originalEvent.wheelDelta;if(c.length){if(a.preventDefault(),b=j(c)[0],!b)return;void 0!==a.originalEvent.deltaMode&&1!==a.originalEvent.deltaMode||(e=30*e),b.scrollTop+=e,this._checkScrollBounds(c,b)}},keydown:function(a){function b(a){var b;if(f.hasClass(U))i=f.find(Y).first().find(ia).first();else{if(b=g.index(f),b+=1,b>=g.length){if(a)return!1;b=0}i=g.eq(b)}return s(i),f=i,n&&C._checkScrollBounds(q,n),!0}function c(a){var b;if(f.hasClass(U))i=f.find(Y).first().find(ia).last();else{if(b=g.index(f),b-=1,b<0){if(a)return!1;b=g.length-1}i=g.eq(b)}return s(i),f=i,n&&C._checkScrollBounds(q,n),!0}function e(){C.toggle(f),f.hasClass(ya)?f.find(Ha).eq(0).focus():(i=f.find(Y).first().find(ia).first(),s(i))}var f,g,h,i,k,l,n,q,r,u,v,w,x,A,B,C=this,D=a.which;if(!a.altKey)if(k=this.element,this.keyboardActivate=!1,k.hasClass(Ea)?(f=k,k.find(Ja).first().each(function(){f=d(this)})):f=k.find(Ga),q=f.closest(V+","+S),n=j(q)[0],l=f.is(S)||m(f),g=l?k.find("."+na):t(q),D===Ra.UP||D===Ra.DOWN)l?f.children(V).length>0&&!f.hasClass(Da)&&(f.hasClass(ya)&&Sa.isCurrentMenu(f.children(V)[0])?(i=f.find("ul").first().children(ia).first(),i.find(Ha).focus()):e()):D===Ra.UP?c():b(),a.preventDefault();else if(D===this.forwardKey)l?(b(),Sa.closeOpenSiblings(f,!0),Sa.isCurrentMenuBar(k[0])&&f.children(V).length>0&&!f.hasClass(Da)&&e()):(i=f.children(V),i.length>0&&!f.hasClass(Da)?(Sa.openSubMenu(f,i,!1,this.options.slide,!1),i=i.find("ul").first().children(ia).first(),s(i)):this.options.menubar&&(f=k.find(Ja).eq(0),g=k.find("."+na),b(),Sa.closeOpenSiblings(f,m(f)),f.children(V).length>0&&!f.hasClass(Da)&&e())),a.preventDefault();else if(D===C.backwardKey)l?(c(),Sa.closeOpenSiblings(f,!0),Sa.isCurrentMenuBar(C.element[0])&&f.children(V).length>0&&!f.hasClass(Da)&&e()):(i=f.parents(ia).eq(0),i.length>0&&!m(i)?Sa.closeLast(!0):this.options.menubar&&(f=k.find(Ja).eq(0),g=k.find("."+na),c(),Sa.closeOpenSiblings(f,m(f)),f.children(V).length>0&&!f.hasClass(Da)&&e())),a.preventDefault();else if(D===Ra.TAB)l?("EXIT"===this.options.tabBehavior||a.shiftKey)&&(z=!0,Sa.closeAll()):(B=this.options.tabBehavior,"NEXT"===B&&(a.shiftKey?c(!0)||(B="EXIT"):b(!0)||(B="EXIT")),"EXIT"===B&&y&&(z=!0,Sa.closeAll(),u=d(":tabbable"),this.options.menubar?(r=u.index(d(y).find(":tabbable")),r<0&&(r=u.index(this.element.find(":tabbable")))):r=u.index(y),r>0&&r<u.length?r+=a.shiftKey?-1:1:u.length>0&&(r=0),r>=0&&u[r].focus()),a.preventDefault());else if(D===Ra.ESCAPE)Sa.closeLast(!0),a.preventDefault();else if(D===Ra.ENTER||D===Ra.SPACE){if(f=k.hasClass(Ea)?k:k.find(Ga),f.hasClass(Da)||!f.is(ia))return void a.preventDefault();if(v=f[0].id,w=this._getMenuItemFromId(v),x=w.type,l=m(f),"subMenu"===x&&l&&(w.action||w.href)&&(x="action",Sa.closeOpenSiblings(f,l)),"subMenu"===x)l?(C.toggle(f),i=f.find(Y).first().find(ia).first(),s(i)):(h=f.children(V),h.length>0&&(Sa.openSubMenu(f,h,!1,this.options.slide,!1),i=h.find("ul").first().children(ia).first(),s(i)));else{if(("A"!==a.target.nodeName||D!==Ra.SPACE)&&("action"===x||D===Ra.SPACE&&"BUTTON"===a.target.nodeName))return void(this.keyboardActivate=!0);"display"!==x&&(A=o(v),p(w,this.actionsContext,A,this.options,x,D===Ra.SPACE)&&(z=!0,Sa.closeAll()))}a.preventDefault()}},keypress:function(a){var b,c,d,e,f,g,h,i,k=-1;if(0!==a.which&&(f=this.element,f.hasClass(Ea)?(e=f.find(Y).first().find(ia).first(),k=0):e=f.find(Ga),g=e.closest(V),0!==g.length))for(h=t(g),k<0&&(k=h.index(e)+1,k>=h.length&&(k=0)),d=h.eq(k),b=String.fromCharCode(a.which).toLowerCase();;){if(i=d.filter(".a-Menu-label"),0===i.length&&(i=d.find(".a-Menu-label")),i.text().charAt(0).toLowerCase()===b){s(d),c=j(g)[0],c&&this._checkScrollBounds(g,c);break}if(k+=1,k>=h.length&&(k=0),d=h.eq(k),d[0]===e[0])break}},focusin:function(a){var b=d(a.target);this.isActive||this.element.find(Ga).removeClass(Ea),b.is(V)?b.addClass(Ea):b.closest(ia).addClass(Ea),this.isActive=!0},focusout:function(a){var b=d(a.target);b.is(V)?b.removeClass(Ea):b.closest(ia).removeClass(Ea),this.isActive=!1},focus:function(){this.element.addClass(Ea)},blur:function(){this.element.removeClass(Ea)}},_destroy:function(){var a=this.options,c=this.element;D&&Sa.isMenuOpen(this.element)&&(b.warn("Menu destroyed while still tracking menus."),Sa.closeAll(!0)),c.empty().removeClass((a.menubar?R+" "+T:U)+" "+Ma+" "+pa).removeAttr("role")},_setOption:function(a,c){var d,e,f,g,h=this.options;if("menubar"===a)throw new Error("The menubar option cannot be set");if(h.menubar?"customContent"!==a&&"firstItemIsDefault"!==a||b.warn("Option "+a+" ignored when menubar is true"):"menubarOverflow"!==a&&"menubarShowSubMenuIcon"!==a&&"behaveLikeTabs"!==a||b.warn("Option "+a+" ignored when menubar is false"),this._super(a,c),"menubarOverflow"===a&&h.menubar){if(this.element.toggleClass(pa,c),!c&&(e=h.items,d=e[e.length-1],d&&d._overflow)){for(g=d.menu.items;g.length>0;)f=g.shift(),"subMenu"===f.type&&(f.action||f.href)&&f.menu.items.shift(),e.splice(e.length-1,0,f);e.pop()}}else"actionsContext"===a&&(this.actionsContext=c||apex.actions)},refresh:function(){var b,c=this.element,d=this.options,e=d.idPrefix||c[0].id||"menu",f=a.htmlBuilder();return d.menubar&&(b=this._renderMenubar(f,e,d),c.html(f.toString()),this._processMenuCustomMarkup(),this.resize()),this},resize:function(){var b,c=this.element,d=this.options,e=d.idPrefix||c[0].id||"menu",f=a.htmlBuilder();return d.menubar&&d.menubarOverflow&&this._adjustMenubarForSize(e,d)&&(b=this._renderMenubar(f,e,d),c.html(f.toString()),this._processMenuCustomMarkup()),this},toggle:function(a,b){var c=this.element;if(this.options.menubar&&(c=null,"number"==typeof a?(a=this.element.children("ul").children("li").eq(a),a.length>0&&(c=a.children(V))):a.is(ia)&&(c=a.children(V)),!c||1!==c.length))throw new Error("Invalid menu bar menu");return Sa.isCurrentMenu(c[0])?Sa.closeAll():this.open(a,b),this},open:function(e,g){function h(){var b;q._trigger("beforeOpen",{},n),j.customContent?("string"==typeof j.customContent&&(k.empty().append(d("#"+a.escapeCSS(j.customContent)).show()),j.customContent=!0),q._parseCustomMarkup(k,m,j)):(t.clear(),b=q._renderMenu(t,m,j,o),k.html(t.toString()))}var i,j,k,l,m,n,o,p=!1,q=this,r=this.options,t=a.htmlBuilder();if(r.menubar){if(l=this.element,k=null,"number"==typeof e?(e=this.element.children("ul").children("li").eq(e),e.length>0&&(k=e.children(V))):e.is(ia)&&(k=e.children(V)),!k||1!==k.length)throw new Error("Invalid menu bar menu");if(m=e[0].id,j=this._getMenuItemFromId(m),!j||"subMenu"!==j.type||!j.menu)throw new Error("Can't open menu "+e);n=j,j=j.menu,o=!1}else l=null,j=r,n={menu:j},k=this.element,m=r.idPrefix||this.element[0].id||"menu",o=!0;if(d.isFunction(r.asyncFetchMenu)){if(!D&&r.menubar)for(i=0;i<r.items.length;i++)r.items[i]._fetched=!1;r.menubar&&n._fetched===!0?h():(q._renderMenu(t,m,{items:[{type:"action",disabled:!0,label:c.getMessage("APEX.MENU.PROCESSING")}]},o),k.html(t.toString()),p=!0,r.asyncFetchMenu(j,function(a){var b;if(Sa.isCurrentMenu(k[0])){if(a===!1)return void Sa.closeAll(!0);b=k.find(Ga).first(),h(),f(),b.length?s(k.find(ia).first()):k.focus()}}),r.menubar&&(n._fetched=!0))}else h();return p||0!==j.items.length?Sa.openMenu(k,l,e,g,r.slide,r.menubar||g!==!1):(b.error("Menu has no items"),q._trigger("afterClose",{},{actionTookFocus:!1,actionTaken:!1,launcher:null})),this},find:function(a){var b=this.options;return n(b,a)},setCurrentMenuItem:function(a){var d,e,f=0,g=this.options.items;if(!this.options.menubar||!this.options.behaveLikeTabs)return void b.warn("setCurrentMenuItem ignored");if("string"==typeof a&&(a=this.find(a)),a){for(f=0;f<g.length;f++)d=g[f],d.current&&(e=d,delete d.current),q(d,!0);for(a.current=!0,f=0;f<g.length;f++)if(d=g[f],q(d)){d.current=!0,r(e),this.element.find("."+za).removeClass(za).find(".a-MenuBar-label").text(e.label),this.element.children("ul").children("li").eq(f).addClass(za).find(".a-MenuBar-label").append(" <span class='u-VisuallyHidden'>"+c.getMessage("APEX.MENU.CURRENT_MENU")+"</span>");break}}},_parseMenuMarkup:function(a,b){var c=this,e={items:[]};return a.children("ul").children("li").each(function(a){var f,g,h,i,j,k,l,m=d(this),n=m.children("a").eq(0),o=m.children("span").eq(0);if(f={type:"action"},n.length>0?(f.label=n.text(),f.href=n.attr("href")):o.length>0?f.label=o.text():f.type="separator","separator"===f.href&&(f.type="separator",delete f.href,delete f.label),i=m.attr("data-id"),i&&(f.id=i),"true"===m.attr("data-hide")&&(f.hide=!0),"true"===m.attr("data-disabled")&&(f.disabled=!0),"true"===m.attr("data-current")&&(f.current=!0),g=m.attr("data-icon"),g&&(h=g.indexOf(" "),h>=0?(f.iconType=g.substring(0,h),f.icon=g.substring(h+1)):f.icon=g),"separator"!==f.type&&(m.children("ul").length>0||"true"===m.attr("data-custom")))if(f.type="subMenu","true"!==m.attr("data-custom"))f.menu=c._parseMenuMarkup(m,!1);else{if(!b)throw new Error("Attribute data-custom only allowed at menubar level");k=m.children(Y).eq(0),j=k[0].id,j||(j=k[0].id=(c.options.idPrefix||c.element[0].id||"menu")+"_cm_"+a),d(document.body).append(k),k.hide(),f.menu={customContent:j}}"action"===f.type&&i&&apex.actions&&(l=c.actionsContext.lookup(i),l&&(f.action=i,delete f.href,delete f.label,delete f.disabled,delete f.icon,delete f.iconType,l.action||l.href?f.type="action":l.get&&l.set&&!l.choices?f.type="toggle":l.choices&&(f.type="radioGroup"))),e.items.push(f)}),e},_parseCustomMarkup:function(a,b,c){var e=this;c.items||(c.items=[]),a.attr("data-custom","true"),0===a.find(Y).length&&a.children().first().addClass(X),a.find(Ha).each(function(a){var f,g,h,i;i=d(this),h=i.closest(ha),i.attr("role","menuitem"),0===h.length&&(h=d(this),h.addClass(ga)),h.hasClass(ra)||0!==h.find(ua).length||i.addClass(ra),h[0].id=b+"_"+a,"A"===this.nodeName&&this.href?(g={type:"action",label:i.text(),href:this.href},c.items[a]=g):"BUTTON"===this.nodeName?(g={type:"action",label:i.text(),action:function(){}},c.items[a]=g):(i.attr("tabindex","-1"),c.items[a]||(g={type:"display",label:i.text(),disabled:!0},c.items[a]=g)),f=h.attr("data-id"),f&&(g.id=f,"action"===g.type&&f&&apex.actions&&e.actionsContext.lookup(f)&&(g.action=f,delete g.href,delete g.label,delete g.disabled,delete g.icon,delete g.iconType))})},_processMenuCustomMarkup:function(){var b=this;this.element.find("."+na).each(function(){var c=d(this).children(V),e=this.id,f=b._getMenuItemFromId(e).menu;f&&f.customContent&&("string"==typeof f.customContent&&(c.empty().append(d("#"+a.escapeCSS(f.customContent)).show()),f.customContent=!0),b._parseCustomMarkup(c,e,f))})},_getMenuItemFromId:function(a){var b,c,d=this.options,e=a.split("_"),f=[],g=null;for(b=e.length-1,e[b].match(/^c[0-9]+$/)&&(b-=1);b>0&&e[b].match(/^[0-9]+$/);b--)f.unshift(1*e[b]);for(c=d.items,b=0;b<f.length;b++){if(g=c[f[b]],!g||b<f.length-1&&!g.menu)return null;g.menu&&(c=g.menu.items)}return g},_itemIsHidden:function(a){var b=a.hide,c=this.options;return d.isFunction(b)&&(b=a.hide(c)),b},_itemIsDisabled:function(a){var b=a.disabled,c=this.options;return d.isFunction(b)&&(b=a.disabled(c)),b},_renderMenubar:function(a,f,g){var h="",i=this,j=0,k=this.options,l="NEXT"===k.tabBehavior;return k.behaveLikeTabs&&d.each(g.items,function(a,b){if(q(b)&&(b.current=!0),b.current)return j=a,!1}),this.element.find("."+W).filter("[data-custom]").each(function(){var a=d(this).children().eq(0),b=i._getMenuItemFromId(a.closest(ia)[0].id);b.menu.customContent=a[0].id,d(document.body).append(a)}),a.markup("<ul>"),d.each(g.items,function(d,g){var m,n,o,p,q,s=g.type,t=f+"_"+d;if("action"===g.type&&"string"==typeof g.action){if(!apex.actions)throw new Error("Action name requires apex.actions");p=i.actionsContext.lookup(g.action),p?(g.hide=!1,p.label&&!g.label&&(g.label=p.label),void 0!==p.hide&&(g.hide=p.hide),void 0!==p.disabled&&(g.disabled=p.disabled),p.href&&!g.href&&(g.href=p.href)):(b.warn("Unknown action name "+g.action+" (item hidden)."),g.hide=!0)}if(!i._itemIsHidden(g)){if(n=na,o=i._itemIsDisabled(g),o&&(n+=" "+Da),"subMenu"===g.type&&(g.action||g.href)&&(n+=" "+ya),k.behaveLikeTabs&&g.current&&(n+=" "+za,q=" <span class='u-VisuallyHidden'>"+c.getMessage("APEX.MENU.CURRENT_MENU")+"</span>"),g._overflow&&(n+=" "+oa),"action"!==s&&"subMenu"!==s)throw new Error("Menu item type not supported in menubar: "+s);a.markup("<li").attr("id",t).attr("class",n).markup(">"),h+=" "+t+"i",r(g),m=g.label,(g.icon||g.iconType)&&b.warn("Menu bar items cannot have icons."),g.accelerator&&b.warn("Menu bar items cannot have accelerators."),o?a.markup("<span role='menuitem'").attr("class",ta).attr("tabindex",l||d===j?"0":"-1").attr("id",t+"i").optionalAttr(Oa,o?"true":null).optionalAttr(Pa,"subMenu"===s?"true":null).markup(">").content(m).markup("</span>"):g.href&&k.useLinks?(a.markup("<a role='menuitem'").attr("class",ta).attr("id",t+"i").attr("href",g.href).optionalAttr("tabindex",l||d===j?null:"-1").optionalAttr(Pa,"subMenu"===s?"true":null).markup(">").content(m),k.behaveLikeTabs&&g.current&&a.markup(q),a.markup("</a>")):(a.markup("<button type='button' role='menuitem'").attr("class",ta).attr("id",t+"i").optionalAttr("tabindex",l||d===j?null:"-1").optionalAttr(Pa,"subMenu"===s?"true":null),g._overflow?a.attr("title",m).markup("><span class='a-Icon icon-down-chevron'></span>"):(a.markup(">").content(m),k.behaveLikeTabs&&g.current&&a.markup(q)),a.markup("</button>")),"subMenu"===s&&((g.action||g.href||k.menubarShowSubMenuIcon)&&!g._overflow&&(a.markup("<span class='"+wa+"'>"),e(a,Ka,!k.menubarShowSubMenuIcon||g.action||g.href?"icon-menu-split-drop-down":"icon-menu-drop-down"),a.markup("</span>")),a.markup("<div").attr("id",t+"m").markup(" class='"+U+" "+W+"' role='menu' tabindex='-1' style='display:none;'></div>")),a.markup("</li>")}}),a.markup("</ul>"),d.trim(h)},_renderMenu:function(c,f,g,h){function i(){s=!1,t>0&&(c.markup("<li class='").markup(Ba).markup("' role='separator'><div class='a-Menu-inner'><span class='a-Menu-labelContainer'><span class='").markup(qa).markup("'></span><span class='").markup(Aa).markup("'></span></span><span class='a-Menu-accelContainer'></span></div></li>"),t+=1)}function j(a,b,d){c.markup("<span class='"+qa+"'>"),(b||""===b)&&e(c,a,b,d),c.markup("</span>")}function k(a){c.markup("<span").attr("class",sa).markup("> ").content(a).markup("</span>")}function l(a,b,d,e,f,g,h,i){var j;b?(c.markup("<span tabindex='-1'").optionalAttr(Oa,b?"true":null),j="</span>"):f&&o.useLinks?(c.markup("<a").attr("href",f),j="</a>"):(c.markup("<button type='button'"),j="</button>"),c.attr("id",a).attr("role",g).attr("class",ra).optionalAttr(Pa,i?"true":null).optionalAttr(Qa,null!==h&&h?"true":null).markup(">"),c.content(d),e&&c.markup(" <span class='u-VisuallyHidden'>").content(e).markup("</span>"),c.markup(j).markup("</span><span class='a-Menu-accelContainer'>"),e&&k(e)}function m(){c.markup("<span class='"+wa+"'></span>")}var n="",o=this.options,p=this,q=this.element.hasClass(Ma),s=!1,t=0,u="icon-menu-sub";return q&&(u="icon-menu-sub-rtl"),c.markup("<div class='"+X+"'><ul>"),d.each(g.items,function(g,k){var q,v,w,x,y,z,A,B,C,D,E,F,G=null,H=k.type,I=f+"_"+g;if(r(k),x=k.icon,y=k.iconType,v=k.label,F=k.href,B=k.accelerator,("action"===k.type||"toggle"===k.type||"radioGroup"===k.type)&&"string"==typeof k.action){if(!apex.actions)throw new Error("Action name requires apex.actions");G=p.actionsContext.lookup(k.action),G?(k.hide=!1,G.icon&&!k.icon&&(x=G.icon),G.iconType&&!k.iconType&&(y=G.iconType),G.label&&!k.label&&(v=G.label),G.shortcut&&!k.accelerator&&(B=G.shortcut),void 0!==G.hide&&(k.hide=G.hide),void 0!==G.disabled&&(k.disabled=G.disabled),void 0!==G.href&&(F=G.href),G.choices&&(k.choices=G.choices)):(b.warn("Unknown action name "+k.action+" (item hidden)."),k.hide=!0)}p._itemIsHidden(k)||(w="separator"===H?Ba:ga,z=p._itemIsDisabled(k),z&&(w+=" "+Da),0===g&&h&&o.firstItemIsDefault&&(w+=" "+ma),"radioGroup"===H?(s=!0,G&&(k=G),q=k.get(),d.each(k.choices,function(a,e){var f=I+"_c"+a,g=q===e.value;B=e.accelerator||null,e.shortcut&&!B&&(B=e.shortcut),w=ga,z=e.disabled,d.isFunction(z)&&(z=e.disabled(o)),z&&(w+=" "+Da),e.icon&&!G&&b.warn("Radio menu items cannot have icons."),s&&i(),c.markup("<li").attr("id",f).attr("class",w).markup("><div class='a-Menu-inner'><span class='a-Menu-labelContainer'>"),j(Ka,g?"icon-menu-radio":""),r(e),C=f+"i",n+=" "+C,l(C,z,e.label,B,null,"menuitemradio",g),m(),c.markup("</span></div></li>"),t+=1}),s=!0):"separator"===H?s=!0:(A="toggle"===H?"menuitemcheckbox":"menuitem",s&&i(),C=I+"i",c.markup("<li id='").attr(I).markup("' class='").attr(w).markup("'><div class='a-Menu-inner'><span class='a-Menu-labelContainer'>"),"action"===H||"display"===H?(j(y||o.iconType,x,k.iconStyle),l(C,z,v,B,F||"",A,null),m(),c.markup("</span></div>")):"toggle"===H?(G&&(k=G),q=k.get(),k.icon&&!G&&b.warn("Toggle menu items cannot have icons."),k.label&&(k.onLabel||k.offLabel)&&b.warn("Toggle menu items should not have both label and on/offLabel properties."),v=k.label,x=q?"icon-menu-check":"",v||(x=null,v=q?k.onLabel:k.offLabel,A="menuitem",q=null),j(Ka,x),l(C,z,v,B,null,A,q),m(),c.markup("</span></div>")):"subMenu"===H&&(j(k.iconType||o.iconType,k.icon,k.iconStyle),l(C,z,k.label,null,"",A,null,!0),k.accelerator&&b.warn("Sub menu items cannot have accelerators."),c.markup("<span class='"+wa+"'>"),e(c,Ka,u),c.markup("</span></span></div>"),D=a.htmlBuilder(),E=p._renderMenu(D,I,k.menu,!1),c.markup("<div class='"+U+"' role='menu' tabindex='-1'").attr("id",C+"m").markup(">"+D.toString()),c.markup("</div>")),n+=" "+C,c.markup("</li>"),t+=1))}),c.markup("</ul></div>"),d.trim(n)},_checkScrollBounds:function(a,b){return a.find(aa).removeClass(Da),b.scrollTop<=0?(a.find(aa+"."+ca).addClass(Da),b.scrollTop=0,!0):b.scrollTop>=b.scrollHeight-b.clientHeight&&(a.find(aa+"."+da).addClass(Da),b.scrollTop=b.scrollHeight-b.clientHeight,!0)},_startScrolling:function(a,b){function c(){return h.scrollTop+=b?-10:10,e._checkScrollBounds(a,h)?void e._stopScrolling():(e.scrollTimerId=setTimeout(function(){c()},g[f]),void(f<g.length-1&&(f+=1)))}var e=this,f=0,g=[100,99,96,91,84,75,64,51,36,19],h=j(a)[0];this.scrollTimerId&&this._stopScrolling(),d(document).on("mouseup.menuScrolling",function(){e._stopScrolling()}).on("mousemove.menuScrolling",function(a){0===d(a.target).closest(aa).length&&e._stopScrolling()}),c()},_stopScrolling:function(){clearTimeout(this.scrollTimerId),this.scrollTimerId=null,this.element.find(aa).removeClass(Fa),d(document).off(".menuScrolling")},_adjustMenubarForSize:function(b,e){var f,g,h,i,j,k,l,m=!1,n=0,o=this.element.width()-2,p=e.items;for(j=p[p.length-1],j&&j._overflow||(j=null),f=0;f<p.length;f++)h=p[f],h.hide?h._width=0:h._width=d("#"+a.escapeCSS(b+"_"+f)).outerWidth(!0),n+=h._width;if(n>o)for(j||(j={type:"subMenu",_overflow:!0,label:c.getMessage("APEX.MENU.OVERFLOW_LABEL"),menu:{items:[]}},p.push(j)),g=j.menu.items,f=p.length-2;f>=0&&n>o;)h=p[f],p.splice(f,1),"subMenu"===h.type&&(h.action||h.href)&&h.menu.items.unshift({type:"action",label:h.label,labelKey:h.labelKey,href:h.href,action:h.action,disabled:h.disabled}),"subMenu"===h.type&&h.menu.customContent&&(l=d("#"+a.escapeCSS(b+"_"+f)),k=l.children(V).children().eq(0),k.hide(),h.menu.customContent=k[0].id,d(document.body).append(k),l.children(V).attr("data-custom",null)),g.unshift(h),n-=void 0!==h._width?h._width:0,m=!0,f-=1;else if(j){for(g=j.menu.items,i=0,f=0;f<g.length&&i<3;f++)g[f]._width>0&&(i+=1);for(1===i&&(n-=this.element.find("."+oa).outerWidth(!0)),delete j.current;g.length>0&&(h=g[0],n+=void 0!==h._width?h._width:0,!(n>o));)g.shift(),"subMenu"===h.type&&(h.action||h.href)&&h.menu.items.shift(),p.splice(p.length-1,0,h),m=!0;0===g.length&&p.pop()}return m}}),d.ui.dialog&&d.widget("ui.dialog",d.ui.dialog,{_allowInteraction:function(a){return d(a.target).closest(V).length>0||this._super(a)}}),d(function(){function c(c,e,f){var g,h=c.attr("data-menu");if(h){if(g=d("#"+a.escapeCSS(h)),!g.length)return void b.error("Menu cannot be found "+h);c.addClass(Fa).attr(Na,"true"),f&&Sa.isCurrentMenu(g[0])||g.menu("toggle",c,!1).on("menuafterclose.menubutton",function(a,b){d(this).off(".menubutton"),c.removeClass(Fa).attr(Na,"false")}),e&&s(g.find(ia).first())}}d("body").on("click",La,function(a){c(d(this),!0,!1)}).on("keydown",La,function(a){a.which===Ra.DOWN?(a.preventDefault(),c(d(this),!0,!0)):a.which===Ra.TAB&&(z=!0,Sa.closeAll())}),d(La).attr(Pa,"true").attr(Na,"false"),d("body").on("apexafterrefresh",function(a){d(a.target).find(La).attr(Pa,"true").attr(Na,"false")})})}(apex.util,apex.debug,apex.lang,apex.jQuery);