!function(a){a.widget("mobile.listview",a.mobile.listview,{options:{childPages:!0,page:"<div data-role='page'></div>",header:"<div data-role='header'><a href='#' data-rel='back'>Back</a><h1></h1></div>",content:"<div class='ui-content'></div>"},_create:function(){this._super(),this.options.childPages&&this._setupChildren()},_setupChildren:function(){this._attachBindings(),this.element.find("ul").css("display","none").parent().addClass("ui-btn ui-btn-icon-right ui-icon-carat-r")},_attachBindings:function(){this._on({click:"_handleSubpageClick"}),this._on("body",{pagechange:function(){this.opening===!0?(this.open=!0,this.opening=!1):this.open===!0&&(this.newPage.remove(),this.open=!1)}})},_handleSubpageClick:function(b){0!=a(b.target).closest("li").children("ul").length&&(this.opening=!0,this.newPage=a(this.options.page).uniqueId(),this.nestedList=a(b.target).children("ul").clone().attr("data-"+a.mobile.ns+"role","listview").css("display","block"),this.pageName=a(b.target.childNodes[0]).text().replace(/^\s+|\s+$/g,"").length>0?a(b.target.childNodes[0]).text():a(b.target.childNodes[1]).text(),this.pageID=this.newPage.attr("id"),this.newPage.append(a(this.options.header).find("h1").text(this.pageName).end()).append(a(this.options.content)).find("div.ui-content").append(this.nestedList),a("body").append(this.newPage),a("body").pagecontainer("change","#"+this.pageID))}})}(jQuery,this);